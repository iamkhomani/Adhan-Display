<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BEKQEF4RR5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-BEKQEF4RR5');
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#050505">
    
    <title>Adhan Display | Smart Islamic Dashboard & Prayer Tracker</title>
    <meta name="description" content="Free smart Adhan dashboard & Islamic prayer tracker. Get offline live prayer times, Qibla compass, and daily inspiration with no subscriptions.">
    <meta name="keywords" content="adhan dashboard, prayer tracker, islamic smart clock, salah tracker, qibla compass, web adhan display, waqtly alternative, bilaal alternative, free prayer app">
    <meta name="author" content="Adhan Display">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="Adhan Display | Smart Islamic Dashboard & Prayer Tracker">
    <meta property="og:description" content="Turn any device into a beautiful, free Adhan display and Salah tracker with offline support and a live Qibla compass.">
    <meta property="og:image" content="images/adhan display muslim prayer times dashboard background.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Adhan Display | Smart Islamic Dashboard">
    <meta name="twitter:description" content="Turn any device into a free Adhan display and Salah tracker.">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Adhan Display">
    <link rel="apple-touch-icon" href="images/adhan display muslim prayer times dashboard logo.png">

    <link rel="icon" type="image/png" href="images/adhan display muslim prayer times dashboard logo.png">
    <link rel="manifest" href="manifest.json">

    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&display=swap" rel="stylesheet">
    
    <style>
        /* === THEME VARIABLES === */
        :root {
            --bg-image: url('images/adhan display muslim prayer times dashboard background.jpg');
            --gold: #D4AF37; --gold-dim: #997d26; --gold-hover: #e8c558;
            --glass-bg: rgba(20, 20, 20, 0.85);
            --glass-header: rgba(0, 0, 0, 0.65);
            --text-main: #f0f0f0; --text-muted: #aaaaaa;
            --border-color: #333333; --progress-bg: #222222;
            --shadow-color: rgba(0,0,0,0.5);
            --danger: #ff4444; --success: #2ecc71; --info: #3498db;
            --highlight-bg: rgba(212, 175, 55, 0.1);
            --input-bg: rgba(255, 255, 255, 0.15);
            --input-focus: rgba(255, 255, 255, 0.25);
        }

        [data-theme="light"] {
            --bg-image: url('images/background-white.jpg');
            --gold: #b8972e; --gold-dim: #8a7122; --gold-hover: #d1b145;
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-header: rgba(240, 240, 240, 0.85);
            --text-main: #1a1a1a; --text-muted: #555555;
            --border-color: #dddddd; --progress-bg: #e0e0e0;
            --shadow-color: rgba(0,0,0,0.1);
            --highlight-bg: rgba(184, 151, 46, 0.15);
            --input-bg: rgba(0, 0, 0, 0.05);
            --input-focus: rgba(0, 0, 0, 0.1);
        }

        [data-theme="green"] {
            --bg-image: url('images/background-green.png');
            --gold: #D4AF37; --gold-dim: #997d26; --gold-hover: #e8c558;
            --glass-bg: rgba(10, 35, 20, 0.85);
            --glass-header: rgba(5, 20, 10, 0.8);
            --text-main: #f0f0f0; --text-muted: #cccccc;
            --border-color: #1a4d2e; --progress-bg: #0a1f12;
            --shadow-color: rgba(0,0,0,0.6);
            --highlight-bg: rgba(212, 175, 55, 0.15);
            --input-bg: rgba(255, 255, 255, 0.15);
            --input-focus: rgba(255, 255, 255, 0.25);
        }

        [data-theme="dynamic"] {
            --glass-bg: rgba(15, 15, 20, 0.85); 
            --glass-header: rgba(10, 10, 15, 0.75);
            --border-color: rgba(212, 175, 55, 0.3);
            --shadow-color: rgba(0,0,0,0.7);
            --input-bg: rgba(255, 255, 255, 0.15);
            --input-focus: rgba(255, 255, 255, 0.25);
        }
        [data-theme="dynamic"][data-time-of-day="fajr"] {
            --bg-image: linear-gradient(135deg, #0d0a1a 0%, #2b183d 50%, #5e2843 100%);
            --text-main: #ffe6e6;
        }
        [data-theme="dynamic"][data-time-of-day="day"] {
            --bg-image: linear-gradient(135deg, #1a2a6c 0%, #11998e 50%, #2b3a4a 100%);
            --text-main: #f0f8ff;
        }
        [data-theme="dynamic"][data-time-of-day="night"] {
            --bg-image: linear-gradient(135deg, #050505 0%, #0a0a1a 50%, #1a1a2e 100%);
            --text-main: #e0e0e0;
        }

        /* Custom Theme Overrides */
        [data-theme="custom"] {
            --glass-bg: rgba(15, 15, 20, 0.80); 
            --glass-header: rgba(10, 10, 15, 0.70);
            --border-color: rgba(212, 175, 55, 0.4);
            --shadow-color: rgba(0,0,0,0.8);
            --text-main: #f0f0f0;
            --input-bg: rgba(255, 255, 255, 0.15);
            --input-focus: rgba(255, 255, 255, 0.25);
        }

        html { font-size: 16px; transition: font-size 0.3s ease; scroll-behavior: smooth; }

        body {
            background-color: #050505; color: var(--text-main);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0; min-height: 100vh; padding-bottom: 80px;
            display: flex; flex-direction: column; overflow-x: hidden;
            transition: color 0.5s ease, filter 1s ease;
        }
        
        body.night-dimmed { filter: brightness(0.5); }

        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-image: var(--bg-image); background-size: cover;
            background-position: center; background-repeat: no-repeat;
            z-index: -1; transition: background-image 1s ease;
        }

        html[dir="rtl"] body { font-family: 'Tajawal', 'Segoe UI', sans-serif; }
        html[dir="rtl"] .top-left-logo { left: auto; right: 20px; }
        html[dir="rtl"] .top-controls { right: auto; left: 20px; }

        .dashboard-container {
            max-width: 1400px; margin: 0 auto; padding: 20px;
            display: grid; grid-template-columns: repeat(12, 1fr);
            gap: 20px; flex: 1; position: relative; width: 100%; box-sizing: border-box;
            transition: all 0.5s ease;
        }

        /* Fixed Top Controls */
        .top-left-logo { position: absolute; top: 20px; left: 20px; width: clamp(50px, 8vw, 70px); height: auto; z-index: 10; }

        .top-controls {
            position: absolute; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 100;
        }

        .control-btn {
            background: var(--glass-bg); border: 1px solid var(--gold); color: var(--text-main); 
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px var(--shadow-color); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            height: 45px;
        }
        .control-btn.icon-only { width: 45px; border-radius: 50%; font-size: 1.4rem; }
        .control-btn.text-btn { padding: 0 15px; border-radius: 25px; font-weight: bold; font-size: 0.95rem; gap: 6px; }
        .control-btn:hover { transform: scale(1.05) translateY(-2px); background: var(--gold); color: #050505; box-shadow: 0 6px 15px rgba(212, 175, 55, 0.3); }

        /* Focus Mode Styles */
        body.focus-mode .dashboard-container > *:not(.prayer-hero) { display: none !important; }
        body.focus-mode header, body.focus-mode footer, body.focus-mode .top-left-logo { display: none !important; }
        body.focus-mode .dashboard-container { 
            display: flex !important; align-items: center !important; justify-content: center !important; 
            min-height: 100vh !important; padding: 20px !important; margin: 0 !important; 
        }
        body.focus-mode .prayer-hero { 
            width: 100% !important; max-width: 1000px !important; 
            background: var(--glass-bg) !important; border: 2px solid var(--gold) !important; 
            box-shadow: 0 20px 50px var(--shadow-color) !important; backdrop-filter: blur(15px) !important; 
            padding: 50px !important; min-height: auto !important; border-radius: 20px !important; 
            display: flex !important; flex-direction: row !important; justify-content: space-between !important; align-items: center !important; gap: 40px !important;
        }
        body.focus-mode .hero-main { flex: 1; text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; }
        body.focus-mode .hero-side { display: flex; flex-direction: column; flex: 0 0 300px; border-left: 1px solid var(--border-color); padding-left: 40px; }
        body.focus-mode .prayer-name-display { font-size: clamp(3rem, 10vw, 6rem) !important; margin: 15px 0 !important; }
        body.focus-mode .countdown-display { font-size: clamp(2.5rem, 8vw, 4.5rem) !important; margin-bottom: 25px !important; }
        body.focus-mode .progress-container { height: 18px !important; margin-top: 30px !important; border-radius: 10px !important; width: 100% !important; }
        body.focus-mode #status-label, body.focus-mode #next-label { font-size: clamp(1.2rem, 3vw, 1.8rem) !important; letter-spacing: 2px !important; }
        body.focus-mode #curr-time { font-size: clamp(1.8rem, 5vw, 2.5rem) !important; margin-bottom: 20px !important; }
        body.focus-mode #focus-btn { border-color: var(--gold) !important; background: var(--gold) !important; color: #050505 !important; z-index: 1000 !important; }
        body.focus-mode .fullscreen-toggle { z-index: 1000 !important; }

        @media (max-width: 850px) {
            body.focus-mode .prayer-hero { flex-direction: column !important; padding: 40px 20px !important; gap: 30px !important; }
            body.focus-mode .hero-side { border-left: none; border-top: 1px solid var(--border-color); padding-left: 0; padding-top: 25px; flex: auto; width: 100%; }
        }

        /* Unified Cards */
        .card { background: var(--glass-bg); border: 1px solid var(--gold); border-radius: 12px; padding: 25px 20px; backdrop-filter: blur(10px); box-shadow: 0 4px 20px var(--shadow-color); transition: all 0.3s ease; display: flex; flex-direction: column; justify-content: center; align-items: center; grid-column: span 12; box-sizing: border-box; width: 100%; position: relative; }
        .card:hover { box-shadow: 0 6px 25px rgba(212, 175, 55, 0.15); transform: translateY(-2px); }
        .widget-title { color: var(--gold-dim); text-transform: uppercase; font-size: 0.85rem; border-bottom: 1px solid var(--gold); width: 100%; text-align: center; padding-bottom: 8px; margin-bottom: 15px; letter-spacing: 1px; font-weight: bold; }
        
        .header-section { grid-column: span 12; text-align: center; margin-bottom: 20px; display: flex; justify-content: center; margin-top: 70px; width: 100%; }
        .title-wrapper { background: var(--glass-header); backdrop-filter: blur(8px); padding: clamp(15px, 4vw, 20px) clamp(20px, 5vw, 40px); border-radius: 20px; border: 1px solid var(--gold); box-shadow: 0 10px 30px var(--shadow-color); width: 100%; max-width: 800px; box-sizing: border-box; }
        h1 { font-family: 'Cinzel', serif; color: var(--gold); font-size: clamp(1.4rem, 4vw, 2.4rem); margin: 0; text-transform: uppercase; letter-spacing: clamp(1px, 2vw, 3px); text-shadow: 0 2px 10px var(--shadow-color); }
        h2 { font-size: clamp(0.75rem, 2vw, 0.9rem); color: var(--text-muted); font-weight: 400; margin: 5px 0 10px 0; letter-spacing: 0.5px; text-transform: uppercase; }
        
        .info-panel { grid-column: span 12; display: flex; flex-wrap: wrap; justify-content: space-around; align-items: center; background: var(--glass-header); border-radius: 12px; padding: 15px; border: 1px solid var(--gold); gap: 15px; box-shadow: 0 4px 10px var(--shadow-color); }
        .date-box { text-align: center; min-width: 100px; flex: 1; padding: 5px; }
        .date-label { color: var(--gold-dim); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; font-weight: bold;}
        .date-val { font-size: clamp(1rem, 3vw, 1.2rem); font-weight: bold; color: var(--text-main); }
        .live-clock { font-size: clamp(1.4rem, 4vw, 1.8rem); font-family: 'Courier New', monospace; color: var(--text-main); font-weight: bold; }

        /* Banners */
        .banner { display: none; grid-column: span 12; width: 100%; box-sizing: border-box; padding: 12px 20px; border-radius: 12px; text-align: center; font-weight: bold; letter-spacing: 1px; box-shadow: 0 4px 10px var(--shadow-color); animation: pulse 2s infinite; }
        #sunnah-banner { background: rgba(46, 204, 113, 0.15); border: 1px solid var(--success); color: var(--success); }
        #jumuah-banner { background: rgba(212, 175, 55, 0.15); border: 1px solid var(--gold); color: var(--gold); }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); } 100% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); } }

        /* Hero */
        .hero-side { display: none; }
        .prayer-hero { text-align: center; position: relative; width: 100%; display: flex; flex-direction: column; justify-content: space-between; align-items: center; min-height: 320px; scroll-margin-top: 80px; }
        .hero-main { width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; }
        .prayer-name-display { font-size: clamp(2.5rem, 8vw, 3.5rem); color: var(--gold); font-weight: 800; line-height: 1.1; margin: 10px 0; letter-spacing: 2px; }
        .countdown-display { font-size: clamp(1.8rem, 6vw, 2.2rem); font-family: 'Courier New', monospace; color: var(--text-main); font-weight: bold; }
        #shuruq-warning { color: var(--danger); font-size: 0.9rem; font-weight: bold; display: none; margin-bottom: 10px; letter-spacing: 1px; }

        .progress-container { width: 100%; height: 12px; background: var(--progress-bg); border-radius: 6px; overflow: hidden; border: 1px solid var(--border-color); margin-top: 20px;}
        .progress-bar { height: 100%; background: var(--gold); width: 0%; transition: width 1s linear; will-change: width; }

        /* Modals & Inputs */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); display: none; align-items: flex-start; 
            justify-content: center; z-index: 2000; backdrop-filter: blur(8px); 
            opacity: 0; transition: opacity 0.3s ease; overflow-y: auto; padding: 5vh 15px; box-sizing: border-box;
        }
        .modal-overlay.active { display: flex; opacity: 1; }
        .settings-panel { 
            background: var(--glass-bg); border: 1px solid var(--gold); padding: 35px 25px; 
            border-radius: 16px; width: 100%; max-width: 480px; position: relative; 
            color: var(--text-main); box-shadow: 0 15px 50px rgba(0,0,0,0.9); margin: 0 auto auto auto; 
        }
        .close-btn { 
            position: absolute; top: 12px; right: 12px; background: rgba(255, 68, 68, 0.9); border: 2px solid #fff; 
            font-size: 1.6rem; color: #fff; cursor: pointer; width: 38px; height: 38px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.6); transition: transform 0.2s; z-index: 10000;
        }
        .close-btn:hover { transform: scale(1.1); background: #cc0000; }
        html[dir="rtl"] .close-btn { right: auto; left: 12px; }

        .setting-group { margin-bottom: 25px; }
        .setting-group label { display: block; margin-bottom: 10px; font-weight: bold; color: var(--gold); text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; }
        .flex-options { display: flex; gap: 8px; flex-wrap: wrap; }
        
        .opt-btn, input[type="text"], input[type="number"], select { 
            flex: 1 1 auto; min-width: 40px; padding: 12px 10px; background: var(--input-bg); 
            border: 1px solid var(--border-color); color: var(--text-main); border-radius: 8px; 
            font-family: inherit; font-size: 0.95rem; transition: all 0.2s; outline: none; box-sizing: border-box;
        }
        ::placeholder { color: var(--text-muted); opacity: 0.8; }
        select option { background-color: #1a1a1a; color: #fff; }
        button.opt-btn { cursor: pointer; font-weight: bold; text-align: center; }
        button.opt-btn:hover { border-color: var(--gold); background: var(--highlight-bg); }
        button.opt-btn.active { background: var(--gold); color: #050505; border-color: var(--gold); }

        input[type="text"]:focus, input[type="number"]:focus, select:focus { border-color: var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.2); background: var(--input-focus); }
        input[type="range"] { flex: 1; accent-color: var(--gold); margin: 10px 0; }
        input[type="file"] { padding: 8px; }

        .toggle-row { display: flex; justify-content: space-between; align-items: center; padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 10px; background: rgba(0,0,0,0.2); gap: 15px; }
        .toggle-row span { flex: 1; line-height: 1.4; }
        
        .preview-btn { background: var(--input-bg); border: 1px solid var(--border-color); color: var(--gold); border-radius: 8px; padding: 0 18px; cursor: pointer; transition: 0.2s; font-size: 1rem; }
        .preview-btn:hover { border-color: var(--gold); background: var(--gold); color: #050505; }

        .btn-gold { 
            background: transparent; border: 2px solid var(--gold); color: var(--gold); padding: 12px 20px; 
            font-size: 0.95rem; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; text-decoration: none; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 8px; font-weight: bold; display: inline-flex; 
            align-items: center; justify-content: center; gap: 10px; margin-top: 10px; width: 100%; max-width: 300px; box-sizing: border-box; text-align: center; 
        }
        .btn-gold:hover { background: var(--gold); color: #050505; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4); transform: translateY(-2px); }

        .history-row { display: flex; justify-content: space-between; align-items: center; padding: 14px 12px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s ease; border-radius: 6px; margin-bottom: 4px; background: rgba(255,255,255,0.02); }
        .history-row:hover { background: var(--highlight-bg); transform: translateX(4px); border-color: var(--gold-dim); }
        .streak-badge { color: #ff9800; font-weight: bold; font-size: 1.1rem; margin-bottom: 20px; text-align: center; background: rgba(255,152,0,0.1); padding: 12px; border-radius: 8px; border: 1px solid rgba(255,152,0,0.3); text-transform: uppercase; letter-spacing: 1px;}

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--gold-dim); }

        .history-container { display: flex; gap: 20px; flex-wrap: wrap; width: 100%; }
        .history-box { flex: 1 1 300px; padding: 20px; background: var(--glass-header); border-radius: 12px; border: 1px solid var(--border-color); box-sizing: border-box; }
        
        .tasbih-circle { width: 140px; height: 140px; border-radius: 50%; background: var(--glass-header); border: 3px solid var(--gold); color: var(--gold); font-size: 3rem; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.15s ease; box-shadow: 0 4px 15px var(--shadow-color); -webkit-tap-highlight-color: transparent; margin: 10px 0; user-select: none; }
        .tasbih-circle:active { transform: scale(0.92); background: rgba(212, 175, 55, 0.2); }
        .tasbih-circle.glow { background: var(--gold); color: #050505; box-shadow: 0 0 30px var(--gold); border-color: #fff; }

        .footer-nav { display: flex; justify-content: center; gap: 20px; margin-bottom: 15px; flex-wrap: wrap; }
        .footer-nav a { color: var(--gold-dim); text-decoration: none; font-size: 0.85rem; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; transition: color 0.2s; }
        .footer-nav a:hover { color: var(--gold); }

        footer { margin-top: auto; text-align: center; padding: 40px 20px; border-top: 1px solid var(--gold); background: var(--glass-header); width: 100%; box-sizing: border-box; }

        /* Tables & Lists */
        #monthly-table th, #monthly-table td { padding: 10px; border-bottom: 1px solid var(--border-color); text-align: center; }
        #monthly-table th { color: var(--gold); font-size: 0.9rem; letter-spacing: 1px; }
        #monthly-table td { font-family: 'Courier New', monospace; font-size: 0.95rem; }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 3px; margin-top: 15px; }
        .cal-header { font-weight: bold; color: var(--gold); text-align: center; padding: 5px; font-size: clamp(0.6rem, 2vw, 0.8rem); text-transform: uppercase; }
        .cal-day { border: 1px solid var(--border-color); border-radius: 4px; padding: 5px 2px; text-align: center; background: rgba(0,0,0,0.2); display: flex; flex-direction: column; justify-content: space-between; min-height: 50px; }
        .cal-day.active { border-color: var(--gold); background: var(--highlight-bg); box-shadow: 0 0 10px rgba(212,175,55,0.3); }
        .cal-greg { font-size: clamp(0.7rem, 2.5vw, 0.9rem); font-weight: bold; color: var(--text-main); }
        .cal-hijri { font-size: 0.7rem; color: var(--text-muted); }

        .adhkar-row { padding: 15px 0; border-bottom: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 10px; }
        .adhkar-arabic { font-family: 'Tajawal', sans-serif; font-size: 1.4rem; color: var(--gold); text-align: right; line-height: 1.6; }
        .adhkar-translation { font-size: 0.9rem; color: var(--text-main); font-style: italic; }

        /* Ambient Screensaver */
        #ambient-screen { 
            display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            background: #000; z-index: 999999; justify-content: center; align-items: center; flex-direction: column;
        }
        body.ambient-active #ambient-screen { display: flex; }
        #ambient-content { 
            text-align: center; animation: floatScreen 40s infinite alternate ease-in-out;
        }
        @keyframes floatScreen { 0% { transform: translate(-10vw, -15vh); } 100% { transform: translate(10vw, 15vh); } }

        /* Anchor scroll offset */
        #tracker, #qibla, #times-card, #quran-card, #qada-card, #ramadan-card { scroll-margin-top: 80px; }

        @media (min-width: 768px) {
            .prayer-hero, .history-card { grid-column: span 12; }
            .times-card, .tasbih-card, .qibla-card, .tools-card, .text-widget, .dua-widget, .night-widget, .names-widget, .ramadan-card, .video-card, .quran-card, .qada-card, .events-card { grid-column: span 6; }
            #install-card-section { grid-column: span 12; }
            .fullscreen-toggle { right: 135px; }
        }
        @media (min-width: 1024px) {
            .prayer-hero { grid-column: span 6; } 
            .times-card { grid-column: span 6; }
            .history-card { grid-column: span 12; }
            .tasbih-card, .qibla-card, .text-widget { grid-column: span 4; } 
            .night-widget, .names-widget, .dua-widget { grid-column: span 4; } 
            .ramadan-card { grid-column: span 12; } 
            .quran-card, .qada-card, .events-card { grid-column: span 4; }
            .tools-card, .video-card { grid-column: span 6; } 
            #install-card-section { grid-column: span 12; }
        }
        @media (max-width: 767px) {
            .top-left-logo { top: 15px; left: 15px; width: 50px; }
            .top-controls { top: 15px; right: 15px; gap: 8px; }
            .control-btn { height: 40px; }
            .control-btn.icon-only { width: 40px; font-size: 1.1rem; }
            .control-btn.text-btn { padding: 0 12px; font-size: 0.85rem; gap: 4px; }
            .header-section { margin-top: 60px; }
            .info-panel { flex-direction: column; gap: 5px; }
            .date-box { width: 100%; padding: 10px 0; border-bottom: 1px solid var(--border-color); }
            .date-box:last-child { border-bottom: none; }
        }

        @media all and (display-mode: standalone) {
            #install-card-section { display: none !important; }
            #fullscreen-btn { display: none !important; }
        }
    </style>
</head>
<body>

    <div id="ambient-screen">
        <div id="ambient-content">
            <div id="ambient-clock" style="font-size: 6rem; font-family: 'Courier New', monospace; font-weight: bold; color: var(--gold);">--:--</div>
            <div id="ambient-next" style="font-size: 2rem; color: #fff; margin-top: 10px;">--</div>
        </div>
    </div>

    <audio id="audio-chime" src="audio/chime.mp3" preload="metadata"></audio>
    <audio id="audio-default" src="audio/adhan.mp3" preload="metadata"></audio>
    <audio id="audio-makkah" src="audio/makkah.mp3" preload="none"></audio>
    <audio id="audio-madinah" src="audio/madinah.mp3" preload="none"></audio>
    <audio id="audio-alafasy" src="audio/alafasy.mp3" preload="none"></audio>

    <div class="top-controls">
        <button id="fullscreen-btn" class="control-btn icon-only" aria-label="Fullscreen" title="Fullscreen">â›¶</button>
        <button id="focus-btn" class="control-btn text-btn" aria-label="Focus Mode">ğŸ•‹ Focus Mode</button>
        <button id="settings-btn" class="control-btn icon-only" aria-label="Settings" title="Settings">âš™ï¸</button>
    </div>
    
    <div id="onboarding-modal" class="modal-overlay" style="z-index: 3000;">
        <div class="settings-panel" style="text-align: center; max-width: 420px; padding-top: 45px; padding-right: 45px;">
            <h2 style="color:var(--gold); margin-top:0; font-family:'Cinzel',serif; font-size: 1.8rem; letter-spacing: 1px;">Welcome</h2>
            <p style="color:var(--text-muted); font-size:0.95rem; margin-bottom:30px; line-height: 1.5;">Personalize your Adhan Display experience. This data is only stored locally.</p>
            
            <div class="setting-group" style="text-align: left;">
                <label>First Name</label>
                <input type="text" id="ob-name" placeholder="e.g. Tariq">
            </div>
            
            <div class="setting-group" style="text-align: left;">
                <label>Birth Year</label>
                <input type="number" id="ob-year" placeholder="e.g. 1995" min="1900" max="2026">
            </div>
            
            <div style="display: flex; gap: 15px; margin-bottom: 30px;">
                <div class="setting-group" style="flex: 1; text-align: left; margin-bottom: 0;">
                    <label>Gender</label>
                    <select id="ob-gender">
                        <option value="">Select...</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="setting-group" style="flex: 1; text-align: left; margin-bottom: 0;">
                    <label>Background</label>
                    <select id="ob-bg">
                        <option value="">Select...</option>
                        <option value="born">Born Muslim</option>
                        <option value="revert">Revert</option>
                    </select>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px;">
                <button onclick="finishOnboarding(true)" class="btn-gold" style="flex: 2; margin: 0; padding: 14px;">Save & Continue</button>
                <button onclick="finishOnboarding(false)" class="opt-btn" style="flex: 1; margin: 0; padding: 14px;">Skip</button>
            </div>
        </div>
    </div>

    <div id="monthly-modal" class="modal-overlay">
        <div class="settings-panel" style="max-width: 800px; padding: 25px;">
            <button class="close-btn" onclick="document.getElementById('monthly-modal').classList.remove('active')">Ã—</button>
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom:1px solid var(--border-color); padding-bottom:15px; margin-bottom: 15px; padding-right: 45px;">
                <h3 style="color:var(--gold); margin:0; font-size: 1.2rem;">Monthly Calendar</h3>
                <div style="display: flex; gap: 5px; flex-wrap: wrap; justify-content: flex-end;">
                    <button class="opt-btn active" id="btn-cal-list" onclick="toggleCalView('list')" style="padding: 5px 15px; min-width: auto; margin: 0;">List</button>
                    <button class="opt-btn" id="btn-cal-grid" onclick="toggleCalView('grid')" style="padding: 5px 15px; min-width: auto; margin: 0;">Grid</button>
                </div>
            </div>
            <div id="monthly-list-view" style="overflow-x: auto; max-height: 60vh;">
                <table id="monthly-table" style="width: 100%; border-collapse: collapse;">
                </table>
            </div>
            <div id="monthly-grid-view" style="display: none; max-height: 60vh; overflow-y: auto;">
                <div class="calendar-grid" id="calendar-grid-container">
                </div>
            </div>
        </div>
    </div>

    <div id="adhkar-modal" class="modal-overlay">
        <div class="settings-panel" style="max-width: 600px; padding: 25px;">
            <button class="close-btn" onclick="document.getElementById('adhkar-modal').classList.remove('active')">Ã—</button>
            <h3 style="color:var(--gold); margin-top:0; border-bottom:1px solid var(--border-color); padding-bottom:15px; padding-right: 45px;">Morning & Evening Adhkar</h3>
            <div style="max-height: 60vh; overflow-y: auto; padding-right: 10px;">
                <div class="adhkar-row">
                    <div class="adhkar-arabic">Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ§Ù„Ù„ÙÙ‘Ù‡Ù Ù…ÙÙ†Ù Ø§Ù„Ø´ÙÙ‘ÙŠÙ’Ø·ÙØ§Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø¬ÙÙŠÙ…Ù<br>Ø§Ù„Ù„Ù‘Ù‡Ù Ù„Ø§Ù Ø¥ÙÙ„ÙÙ€Ù‡Ù Ø¥ÙÙ„Ø§ÙÙ‘ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙÙ‘ Ø§Ù„Ù’Ù‚ÙÙŠÙÙ‘ÙˆÙ…Ù... (Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ)</div>
                    <div class="adhkar-translation">"I seek refuge in Allah from Satan the outcast. Allah! There is no deity except Him, the Ever-Living, the Sustainer of [all] existence..." (Ayat al-Kursi - 1x)</div>
                    <button class="btn-gold adhkar-counter" data-max="1" style="max-width: 100%; margin-top: 5px;" onclick="countAdhkar(this)">Tap to Count (0/1)</button>
                </div>
                <div class="adhkar-row">
                    <div class="adhkar-arabic">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù. Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ...</div>
                    <div class="adhkar-translation">Surah Al-Ikhlas, Al-Falaq, and An-Nas. (3x each in morning/evening)</div>
                    <button class="btn-gold adhkar-counter" data-max="3" style="max-width: 100%; margin-top: 5px;" onclick="countAdhkar(this)">Tap to Count (0/3)</button>
                </div>
                <div class="adhkar-row">
                    <div class="adhkar-arabic">Ø±ÙØ¶ÙÙŠØªÙ Ø¨ÙØ§Ù„Ù„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘Ø§Ù‹ØŒ ÙˆÙØ¨ÙØ§Ù„Ù’Ø¥ÙØ³Ù’Ù„ÙØ§Ù…Ù Ø¯ÙÙŠÙ†Ø§Ù‹ØŒ ÙˆÙØ¨ÙÙ…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù ØµÙÙ„ÙÙ‘Ù‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡Ù ÙˆÙØ³ÙÙ„ÙÙ‘Ù…Ù Ù†ÙØ¨ÙÙŠÙ‘Ø§Ù‹</div>
                    <div class="adhkar-translation">"I am pleased with Allah as my Lord, with Islam as my religion and with Muhammad (peace and blessings of Allah be upon him) as my Prophet." (3x)</div>
                    <button class="btn-gold adhkar-counter" data-max="3" style="max-width: 100%; margin-top: 5px;" onclick="countAdhkar(this)">Tap to Count (0/3)</button>
                </div>
                <div class="adhkar-row">
                    <div class="adhkar-arabic">Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù</div>
                    <div class="adhkar-translation">"Glory is to Allah and praise is to Him." (100x)</div>
                    <button class="btn-gold adhkar-counter" data-max="100" style="max-width: 100%; margin-top: 5px;" onclick="countAdhkar(this)">Tap to Count (0/100)</button>
                </div>
                <button class="opt-btn" onclick="resetAllAdhkar()" style="width: 100%; margin-top: 15px;">Reset All Counters</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal-overlay">
        <div class="settings-panel">
            <button id="close-settings" class="close-btn" title="Close Settings">Ã—</button>
            <h3 data-i18n="pref" style="color:var(--gold); margin-top:0; border-bottom:1px solid var(--gold); padding-bottom:15px; margin-bottom: 25px; font-size: 1.4rem; padding-right: 45px;">Preferences</h3>
            
            <div class="setting-group" style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; border: 1px solid var(--border-color);">
                <label style="margin-bottom: 15px;">Customize Dashboard (Show/Hide)</label>
                <div id="widget-toggles-list" style="display: flex; flex-direction: column; gap: 8px; max-height: 200px; overflow-y: auto; padding-right: 5px;">
                </div>
            </div>

            <div class="setting-group">
                <label>Locations</label>
                <div id="location-list" style="margin-bottom: 10px; display: flex; flex-direction: column; gap: 8px;"></div>
                <div style="display: flex; gap: 8px; margin-top: 15px; border-top: 1px dashed var(--border-color); padding-top: 15px;">
                    <input type="text" id="new-loc-name" placeholder="City name (e.g. London)">
                    <button onclick="addManualLocation()" class="btn-gold" style="width:auto; margin:0; padding: 12px 20px;">Add</button>
                </div>
            </div>

            <div class="setting-group">
                <label>Calculation Method</label>
                <select id="calc-method">
                    <option value="2">Islamic Society of North America (ISNA)</option>
                    <option value="3" selected>Muslim World League (MWL)</option>
                    <option value="4">Umm Al-Qura University, Makkah</option>
                    <option value="5">Egyptian General Authority of Survey</option>
                    <option value="8">Gulf Region</option>
                    <option value="9">Kuwait</option>
                    <option value="10">Qatar</option>
                    <option value="11">Majlis Ugama Islam Singapura, Singapore</option>
                    <option value="12">Union Organization islamic de France</option>
                    <option value="13">Diyanet Ä°ÅŸleri BaÅŸkanlÄ±ÄŸÄ±, Turkey</option>
                </select>
            </div>

            <div style="display: flex; gap: 15px;">
                <div class="setting-group" style="flex: 1;">
                    <label>Manual Offset (Min)</label>
                    <input type="number" id="manual-offset" value="0" placeholder="e.g. 5">
                </div>
                <div class="setting-group" style="flex: 1;">
                    <label>Hijri Offset (Days)</label>
                    <input type="number" id="hijri-offset" value="0" min="-2" max="2" placeholder="e.g. 1">
                </div>
            </div>
            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: -10px; margin-bottom: 25px; line-height: 1.4;">Adjust times to perfectly match your local mosque/moon sighting.</div>

            <div class="setting-group">
                <label data-i18n="lang">Language</label>
                <select id="lang-select" class="opt-btn" style="width: 100%;">
                    <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                    <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Arabic)</option>
                    <option value="ur">ğŸ‡µğŸ‡° Ø§Ø±Ø¯Ùˆ (Urdu)</option>
                    <option value="id">ğŸ‡®ğŸ‡© Bahasa Indonesia</option>
                    <option value="bn">ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)</option>
                    <option value="tr">ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e</option>
                    <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                    <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                    <option value="nl">ğŸ‡³ğŸ‡± Nederlands</option>
                    <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                    <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                </select>
            </div>

            <div class="setting-group">
                <label data-i18n="theme">Theme Background</label>
                <div class="flex-options">
                    <button class="opt-btn theme-btn" data-theme-val="dark">Dark</button>
                    <button class="opt-btn theme-btn" data-theme-val="light">Light</button>
                    <button class="opt-btn theme-btn" data-theme-val="green">Green</button>
                    <button class="opt-btn theme-btn" data-theme-val="dynamic" data-i18n="dynamic">Dynamic</button>
                    <button class="opt-btn theme-btn" data-theme-val="custom">Custom</button>
                </div>
                
                <div id="custom-bg-section" style="display: none; margin-top: 15px; padding: 15px; border: 1px dashed var(--gold); border-radius: 8px;">
                    <label style="font-size: 0.85rem; text-transform: none; color: var(--gold);">Upload Custom Image</label>
                    <input type="file" id="custom-bg-upload" accept="image/*" class="opt-btn" style="padding: 8px; width: 100%; margin-top: 5px;">
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px;">Image is automatically compressed and saved locally.</div>
                </div>
            </div>

            <div class="setting-group">
                <label data-i18n="size">Text Size</label>
                <div class="flex-options">
                    <button class="opt-btn text-btn" data-size-val="small">A-</button>
                    <button class="opt-btn text-btn" data-size-val="normal">A</button>
                    <button class="opt-btn text-btn" data-size-val="large">A+</button>
                </div>
            </div>

            <div class="setting-group">
                <label data-i18n="audio_pref">Audio & Alerts</label>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 15px;">
                    <div style="display: flex; gap: 8px;">
                        <button class="opt-btn adhan-btn" data-adhan-val="default" style="flex: 1;">Default</button>
                        <button class="preview-btn" onclick="previewAudio('default', this)" title="Play/Stop">â–¶</button>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="opt-btn adhan-btn" data-adhan-val="makkah" style="flex: 1;">Makkah</button>
                        <button class="preview-btn" onclick="previewAudio('makkah', this)" title="Play/Stop">â–¶</button>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="opt-btn adhan-btn" data-adhan-val="madinah" style="flex: 1;">Madinah</button>
                        <button class="preview-btn" onclick="previewAudio('madinah', this)" title="Play/Stop">â–¶</button>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="opt-btn adhan-btn" data-adhan-val="alafasy" style="flex: 1;">Alafasy</button>
                        <button class="preview-btn" onclick="previewAudio('alafasy', this)" title="Play/Stop">â–¶</button>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button class="opt-btn adhan-btn" data-adhan-val="custom" style="flex: 1;">Custom Upload</button>
                        <button class="preview-btn" onclick="previewAudio('custom', this)" title="Play/Stop">â–¶</button>
                    </div>
                    <div id="custom-audio-section" style="display: none; padding: 10px; border: 1px dashed var(--gold); border-radius: 8px; margin-top: 5px;">
                        <input type="file" id="custom-adhan-upload" accept="audio/*" class="opt-btn" style="padding: 8px; width: 100%;">
                        <div id="custom-audio-status" style="font-size: 0.75rem; color: var(--success); margin-top: 8px;"></div>
                    </div>

                    <button class="opt-btn adhan-btn" data-adhan-val="none" style="width: 100%;">None</button>
                </div>
                
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding: 0 5px;">
                    <span style="font-size: 0.95rem; font-weight: 500; color: var(--gold);">Volume</span>
                    <input type="range" id="adhan-volume" min="0" max="1" step="0.1" value="1">
                </div>

                <div class="toggle-row">
                    <span data-i18n="wudu_alert" style="font-size: 0.95rem; font-weight: 500;">10-Min Wudu Alert & Push</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="wudu-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>
                
                <div class="toggle-row">
                    <span style="font-size: 0.95rem; font-weight: 500;">Tahajjud Alarm (30m before Fajr)</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="tahajjud-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>

                <div class="toggle-row">
                    <span style="font-size: 0.95rem; font-weight: 500;">9:00 AM Daily Inspiration</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="daily-alert-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>
                
                <div class="toggle-row">
                    <span style="font-size: 0.95rem; font-weight: 500;">Auto-Dim Display at Night</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="autodim-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>
                <div class="toggle-row">
                    <span style="font-size: 0.95rem; font-weight: 500;">Ambient Screensaver (5m inactivity)</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="screensaver-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>
            </div>

            <div class="setting-group" style="margin-top: 25px; border-top: 1px solid var(--border-color); padding-top: 25px;">
                <label>Prayer Tracker Settings</label>
                <div class="toggle-row">
                    <span style="font-size: 0.95rem; font-weight: 500;">Auto-Add Missed Prayers to Qada</span>
                    <label class="switch" style="cursor: pointer;">
                        <input type="checkbox" id="auto-qada-toggle" style="accent-color: var(--gold); transform: scale(1.4); cursor: pointer;">
                    </label>
                </div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">If left unchecked by 4:00 AM, the app automatically assumes a prayer was missed and adds it to your Qada count.</div>
            </div>

            <div class="setting-group">
                <label data-i18n="daily_source">Daily Inspiration Source</label>
                <div class="flex-options">
                    <button class="opt-btn text-source-btn" data-source-val="quran">Ayah</button>
                    <button class="opt-btn text-source-btn" data-source-val="hadith">Hadith</button>
                </div>
            </div>

            <div class="setting-group" style="margin-top: 35px; border-top: 1px solid var(--border-color); padding-top: 25px;">
                <label>Data Management & Cloud Sync</label>
                <button onclick="exportPrayerData()" class="btn-gold" style="width: 100%; max-width: 100%; margin: 0 0 10px 0;">ğŸ“¥ Export CSV (For Spreadsheets)</button>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="exportBackupJSON()" class="opt-btn" style="flex: 1; padding: 12px; background: rgba(52, 152, 219, 0.2); color: #3498db; border-color: #3498db;">â˜ï¸ Export Backup (For New Device)</button>
                    
                    <label class="opt-btn" style="flex: 1; padding: 12px; background: rgba(46, 204, 113, 0.2); color: #2ecc71; border-color: #2ecc71; text-align: center; cursor: pointer; margin: 0;">
                        â˜ï¸ Import Backup
                        <input type="file" id="import-json-upload" accept=".json" style="display: none;" onchange="importBackupJSON(event)">
                    </label>
                </div>
                <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 8px; text-align: center;">Use Backup/Restore to perfectly transfer your settings and trackers to a new device.</div>
            </div>

        </div>
    </div>

    <main class="dashboard-container">
        <img src="images/adhan display muslim prayer times dashboard logo.png" alt="Adhan Display Logo" class="top-left-logo">

        <header class="header-section">
            <div class="title-wrapper">
                <h1>Adhan Display & Prayer Tracker</h1>
                <h2 data-i18n="subtitle">The Ultimate Free Islamic Prayer Times & Qibla Dashboard</h2>
                <div id="welcome-message" style="color: var(--gold); font-size: 1.1rem; margin-top: 10px; font-weight: bold; display: none;"></div>
            </div>
        </header>

        <section class="info-panel card-item" id="info-panel">
            <div class="date-box">
                <div class="date-label" data-i18n="greg">Gregorian</div>
                <div class="date-val" id="greg-date">--/--/----</div>
            </div>
            <div class="date-box">
                <div class="date-label" data-i18n="time">Current Time</div>
                <div class="live-clock" id="live-clock">--:--:--</div>
                <div id="weather-display" style="font-size: 0.85rem; color:var(--gold-dim); margin-top: 4px;">Loading...</div>
            </div>
            <div class="date-box">
                <div class="date-label" data-i18n="loc">Location</div>
                <div class="location-val" id="location-name" style="color:var(--text-main); font-weight: bold; font-size: 1.1rem;">Detecting...</div>
            </div>
            <div class="date-box">
                <div class="date-label" data-i18n="hijri">Hijri</div>
                <div class="date-val" id="hijri-date">-- -- ----</div>
            </div>
        </section>

        <article class="card ramadan-card card-item" id="ramadan-card">
            <div id="ramadan-countdown-container" style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; width: 100%;">
                <div class="widget-title" data-i18n="ramadan">Ramadan Countdown</div>
                <div id="ramadan-val" style="font-size: clamp(3rem, 8vw, 4.5rem); font-weight: bold; color: var(--gold); line-height: 1; margin-bottom: 5px;">--</div>
                <div style="font-size:1rem; color:var(--text-muted); text-transform: uppercase; letter-spacing: 2px;" data-i18n="days">Days Remaining</div>
            </div>
            <div id="ramadan-panel" style="display: none; border-color: var(--success); text-align: center; width: 100%;">
                <div id="fasting-label" style="color:var(--success); text-transform:uppercase; font-size:0.8rem; letter-spacing: 1px; width: 100%;">Fasting Timer</div>
                <div id="fasting-timer" style="font-size: clamp(1.8rem, 5vw, 2.5rem); font-family: 'Courier New', monospace; font-weight: bold; color: var(--text-main); margin-top: 5px; width: 100%;">--:--:--</div>
                <div style="font-size: 0.85rem; color: var(--gold-dim); margin-top: 15px; width: 100%;" id="ashra-label">Ashra: Mercy (Days 1-10)</div>
                <div class="progress-container" style="height: 10px; margin-top: 5px; margin-left: auto; margin-right: auto;">
                    <div class="progress-bar" id="ashra-progress-fill" style="background: var(--success); width: 0%;"></div>
                </div>
                <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 8px; width: 100%; font-weight: bold;" id="ramadan-day-label">Day -- of 30</div>
            </div>
        </article>

        <div id="sunnah-banner" class="banner">ğŸŒ™ <span id="sunnah-text">Sunnah Fasting Today</span></div>
        <div id="jumuah-banner" class="banner">ğŸ•Œ It's Jumu'ah! Remember to read Surah Al-Kahf and send Salawat.</div>

        <section class="card prayer-hero card-item" id="hero">
            <div class="hero-main">
                <div class="date-label" id="status-label" data-i18n="curr">Current Prayer</div>
                <div class="prayer-name-display" id="curr-name">Loading...</div>
                <div id="shuruq-warning" data-i18n="nopray">* Not permissible to pray *</div>
                <div class="prayer-time-display" id="curr-time" style="font-size:1.6rem; color:var(--text-muted); font-weight: 500;">--:--</div>
                
                <div style="margin-top: 40px; width: 100%; max-width: 600px;">
                    <div class="date-label" id="next-label" data-i18n="next">Next Prayer In</div>
                    <div class="countdown-display" id="timer-display">--:--:--</div>
                    <div class="progress-container"><div class="progress-bar" id="progress-fill"></div></div>
                </div>
            </div>
            
            <div class="hero-side focus-only">
                <h3 style="color: var(--gold); margin-top: 0; font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid var(--gold-dim); padding-bottom: 10px; margin-bottom: 15px;">Today's Times</h3>
                <div id="focus-times-list" style="width: 100%; font-size: 1.1rem; display: flex; flex-direction: column; gap: 8px;"></div>
            </div>
        </section>

        <section class="card times-card card-item" id="times-card">
            <div class="widget-title" style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--gold); width: 100%; margin: 0 0 15px 0; padding-bottom: 12px;">
                <button onclick="changeTrackerDate(-1)" style="background: var(--progress-bg); border: 1px solid var(--border-color); color: var(--gold); width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.borderColor='var(--gold)'" onmouseout="this.style.borderColor='var(--border-color)'"><</button>
                <div style="text-align: center; line-height: 1.3;">
                    <span data-i18n="daily_times" style="font-size: 0.9rem;">Daily Prayer Times</span><br>
                    <span id="trackerDate" style="color: var(--text-main); font-size: 0.8rem; text-transform: none; font-weight: bold;">--/--/----</span>
                </div>
                <button onclick="changeTrackerDate(1)" style="background: var(--progress-bg); border: 1px solid var(--border-color); color: var(--gold); width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.borderColor='var(--gold)'" onmouseout="this.style.borderColor='var(--border-color)'">></button>
            </div>
            
            <div id="daily-times-list" style="width: 100%; display: flex; flex-direction: column;">
                <div style="text-align: center; color: var(--text-muted); font-size: 0.95rem; padding: 20px;">Loading times...</div>
            </div>
            
            <button onclick="openMonthlyTimetable()" class="btn-gold" style="width: 100%; max-width: 100%; margin-top: 15px; font-size: 0.85rem;">ğŸ“… View Full Month Timetable</button>
        </section>

        <section class="card history-card card-item" id="tracker" style="width: 100%;">
            <div style="width: 100%; border-bottom: 1px solid var(--gold); padding-bottom: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                <div class="widget-title" style="border: none; margin: 0; padding: 0; text-align: left; font-size: 1rem;" data-i18n="tracker_title">Prayer Tracker Summary</div>
                <button id="haidh-btn" onclick="toggleHaidhMode()" class="opt-btn" style="font-size: 0.8rem; padding: 5px 10px; min-width: auto; margin:0; border-color: var(--danger); color: var(--danger);">ğŸ©¸ Exemption Mode: OFF</button>
            </div>
            
            <div id="haidh-notice" style="display: none; width: 100%; text-align: center; padding: 20px; background: rgba(255, 68, 68, 0.1); border: 1px dashed var(--danger); border-radius: 8px; color: var(--text-main); margin-bottom: 20px;">
                <h3 style="color: var(--danger); margin-top: 0;">ğŸ©¸ Exemption Mode Active</h3>
                <p style="font-size: 0.9rem; margin-bottom: 0;">You are currently exempt from Salah. Your daily streak is safely maintained.</p>
            </div>

            <div class="history-container" id="history-container-main">
                <div class="history-box">
                    <div id="streak-display" class="streak-badge">ğŸ”¥ 0 Day Streak</div>
                    
                    <p style="margin: 0 0 8px 0; font-size: 1rem;"><strong data-i18n="last_7">Last 7 Days:</strong> <span id="weekScore" style="color: var(--gold); font-weight: bold;">0</span> / <span id="weekTotal">0</span></p>
                    <div class="progress-container" style="margin-top: 5px; margin-bottom: 25px; border-color: var(--border-color); height: 10px;"><div class="progress-bar" id="weekBar" style="background: var(--success);"></div></div>
                    
                    <p style="margin: 0 0 8px 0; font-size: 1rem;"><strong data-i18n="last_30">Last 30 Days:</strong> <span id="monthScore" style="color: var(--gold); font-weight: bold;">0</span> / <span id="monthTotal">0</span></p>
                    <div class="progress-container" style="margin-top: 5px; margin-bottom: 10px; border-color: var(--border-color); height: 10px;"><div class="progress-bar" id="monthBar" style="background: var(--success);"></div></div>
                
                    <p style="margin: 15px 0 8px 0; font-size: 1rem; border-top: 1px dashed var(--border-color); padding-top: 15px;">
                        <strong>Total Prayers Tracked:</strong> 
                        <span id="total-prayers-count" style="color: var(--gold); font-weight: bold; font-size: 1.2rem;">0</span>
                    </p>
                </div>

                <div class="history-box">
                    <h3 style="margin-top: 0; font-size: 1.05rem; color: var(--gold); border-bottom: 1px solid var(--border-color); padding-bottom: 12px; margin-bottom: 10px;" data-i18n="past_days">Past Days (Tap to Edit)</h3>
                    <div id="historyLog" style="max-height: 180px; overflow-y: auto; padding-right: 10px; font-size: 1rem;">
                        <div style="color: var(--text-muted); text-align: center; margin-top: 20px; font-style: italic;">Loading...</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="card qada-card card-item" id="qada-card">
            <div class="widget-title" style="margin-bottom: 15px;">Missed Prayers (Qada)</div>
            <div id="qada-list" style="width: 100%; display: flex; flex-direction: column; gap: 5px;">
                </div>
        </section>

        <section class="card quran-card card-item" id="quran-card">
            <div class="widget-title">Quran Reading Tracker</div>
            <div style="display: flex; flex-direction: column; gap: 15px; width: 100%; justify-content: center; flex: 1;">
                <div style="display: flex; gap: 10px; width: 100%;">
                    <input type="text" id="quran-surah" placeholder="Surah Name or Number" style="flex: 2;">
                    <input type="number" id="quran-ayah" placeholder="Ayah" style="flex: 1;">
                </div>
                <button onclick="saveQuranProgress()" class="btn-gold" style="width: 100%; max-width: 100%; margin: 0;">ğŸ’¾ Save Progress</button>
                <div id="quran-status" style="color: var(--success); font-size: 0.85rem; text-align: center; height: 15px;"></div>
            </div>
        </section>

        <section class="card events-card card-item" id="events-card">
            <div class="widget-title">Upcoming Islamic Events</div>
            <div id="events-list" style="width: 100%; display: flex; flex-direction: column; gap: 5px; flex: 1; justify-content: center;">
                <div style="color: var(--text-muted); text-align: center;">Calculating...</div>
            </div>
        </section>

        <section class="card tools-card card-item" id="tools-card">
            <div class="widget-title" data-i18n="resources">Tools & Resources</div>
            <div style="display: flex; flex-direction: column; gap: 10px; width: 100%; justify-content: center; flex: 1;">
                <button onclick="document.getElementById('adhkar-modal').classList.add('active')" class="btn-gold" style="width: 100%; max-width: 100%; margin: 0; background: rgba(212,175,55,0.1);">ğŸ¤² Morning & Evening Adhkar</button>

                <div style="display: flex; gap: 10px; width: 100%;">
                    <a href="https://www.google.com/maps/search/mosques+near+me/" target="_blank" class="btn-gold" style="flex: 1; max-width: 100%; font-size: 0.8rem; margin: 0; padding: 10px;">ğŸ“ Nearby Mosques</a>
                    <a href="https://www.google.com/maps/search/halal+food+near+me/" target="_blank" class="btn-gold" style="flex: 1; max-width: 100%; font-size: 0.8rem; margin: 0; padding: 10px;">ğŸ” Halal Food</a>
                </div>
                <a href="https://www.myprayer.org/pages/my-prayer-book" target="_blank" class="btn-gold" style="max-width: 100%; margin: 0;">ğŸ“– <span data-i18n="revert_guide">Step-by-Step Prayer Guide</span></a>
                <div style="display: flex; gap: 10px; width: 100%;">
                    <a href="https://apps.apple.com/us/app/namaz-app-learn-salah-prayer/id1447056625" target="_blank" class="btn-gold" style="flex: 1; max-width: 100%; font-size: 0.8rem; margin: 0;">ğŸ“± Namaz App (iOS)</a>
                    <a href="https://play.google.com/store/apps/details?id=com.nurios.namazapp" target="_blank" class="btn-gold" style="flex: 1; max-width: 100%; font-size: 0.8rem; margin: 0;">ğŸ“± Namaz App (Android)</a>
                </div>
                <a href="https://www.zakat.org/resource-center/zakat-calculator" target="_blank" class="btn-gold" style="max-width: 100%; margin: 0;">ğŸ§® <span data-i18n="zakat_calc">Zakat Calculator</span></a>
            </div>
        </section>

        <section class="card video-card card-item" id="video-card">
            <div class="widget-title" data-i18n="live_stream">Holy Sites Live</div>
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; width: 100%;">
                <div style="display: flex; gap: 10px; margin-bottom: 20px; width: 100%;">
                    <button class="opt-btn active" id="btn-makkah" onclick="setStream('makkah')" style="flex: 1; padding: 15px;">Makkah</button>
                    <button class="opt-btn" id="btn-madinah" onclick="setStream('madinah')" style="flex: 1; padding: 15px;">Madinah</button>
                </div>
                <a id="stream-link" href="https://www.youtube.com/results?search_query=makkah+live" target="_blank" class="btn-gold" style="margin: 0;">
                    <span style="height: 10px; width: 10px; background-color: var(--danger); border-radius: 50%; display: inline-block; box-shadow: 0 0 8px var(--danger); animation: pulse 2s infinite;"></span> 
                    <span data-i18n="watch">Watch Stream</span>
                </a>
            </div>
        </section>

        <section class="card tasbih-card card-item" id="tasbih-card">
            <div class="widget-title" data-i18n="tasbih">Digital Tasbih</div>
            <div style="display:flex; flex-direction:column; align-items:center; justify-content: center; height: 100%; padding: 20px 0;">
                <button id="tasbih-btn" class="tasbih-circle" onclick="incrementTasbih()" aria-label="Tap to count Tasbih">0</button>
                <button onclick="resetTasbih()" style="margin-top:20px; background:var(--progress-bg); border:1px solid var(--border-color); border-radius: 20px; padding: 6px 20px; color:var(--text-muted); cursor:pointer; font-size: 0.9rem; transition: all 0.2s;" onmouseover="this.style.color='var(--gold)'; this.style.borderColor='var(--gold)';" onmouseout="this.style.color='var(--text-muted)'; this.style.borderColor='var(--border-color)';">Reset Counter</button>
            </div>
        </section>

        <section class="card qibla-card card-item" id="qibla-card">
            <div class="widget-title" data-i18n="qibla">Qibla Direction</div>
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1;">
                <div id="qibla-degree" style="font-size:4rem; font-weight:bold; color:var(--gold); margin: 15px 0; text-shadow: 0 2px 10px var(--shadow-color);">--Â°</div>
                <div style="font-size:1rem; color:var(--text-muted); margin-bottom: 25px; text-transform: uppercase; letter-spacing: 1px;" data-i18n="north">from true North</div>
                <a href="https://qiblafinder.withgoogle.com/" target="_blank" class="btn-gold" data-i18n="ar_find" style="margin-top: auto;">ğŸ§­ Open Qibla Compass</a>
            </div>
        </section>

        <article class="card text-widget card-item" id="text-widget">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; border-bottom: 1px solid var(--gold); padding-bottom: 8px; margin-bottom: 15px;">
                <span style="width: 24px;"></span>
                <span class="widget-title" id="daily-title" data-i18n="ayah" style="border: none; margin: 0; padding: 0;">Ayah of the Day</span>
                <a id="quran-link" href="https://quran.com" target="_blank" style="text-decoration: none; font-size: 0.95rem; font-weight: bold; display: none; align-items: center; gap: 5px; transition: transform 0.2s; color: var(--gold);" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'" title="Read on Quran.com">ğŸ“– [Quran.com]</a>
                <span id="no-link-spacer" style="width: 24px; display: block;"></span>
            </div>
            <div id="daily-text" style="font-style:italic; text-align:center; color:var(--text-main); font-size: 1.15rem; line-height: 1.6; padding: 15px 0;">Loading...</div>
            <div id="daily-ref" style="color:var(--gold); font-size:0.85rem; margin-top:10px; width:100%; text-align:right; font-weight: bold;"></div>
        </article>

        <section class="card night-widget card-item" id="night-widget">
            <div class="widget-title" data-i18n="qiyam">Night Prayers (Qiyam)</div>
            <div style="display:flex; justify-content:space-around; width:100%; align-items: center; height: 100%;">
                <div style="text-align:center; background: var(--glass-header); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); flex: 1; margin: 0 10px;">
                    <div id="midnight-time" style="font-size:1.5rem; color:var(--gold); font-weight:bold; margin-bottom: 5px;">--:--</div>
                    <div style="font-size:0.8rem; color:var(--text-muted); text-transform: uppercase; letter-spacing: 1px;" data-i18n="mid">Midnight</div>
                </div>
                <div style="text-align:center; background: var(--glass-header); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); flex: 1; margin: 0 10px;">
                    <div id="last-third-time" style="font-size:1.5rem; color:var(--gold); font-weight:bold; margin-bottom: 5px;">--:--</div>
                    <div style="font-size:0.8rem; color:var(--text-muted); text-transform: uppercase; letter-spacing: 1px;" data-i18n="tahajjud">Tahajjud</div>
                </div>
            </div>
        </section>

        <article class="card names-widget card-item" id="names-widget">
            <div class="widget-title" data-i18n="allah">Name of Allah</div>
            <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; flex: 1;">
                <div id="allah-ar" style="font-size:3rem; color:var(--gold); font-family: 'Tajawal', sans-serif; text-shadow: 0 2px 10px var(--shadow-color);">--</div>
                <div id="allah-en" style="font-weight:bold; color:var(--text-main); font-size: 1.3rem; margin: 10px 0; letter-spacing: 1px;">--</div>
                <div id="allah-meaning" style="font-size:0.95rem; font-style:italic; color:var(--text-muted); text-align: center; max-width: 80%;">--</div>
            </div>
        </article>

        <article class="card dua-widget card-item" id="dua-widget">
            <div style="display: flex; justify-content: center; align-items: center; width: 100%; border-bottom: 1px solid var(--gold); padding-bottom: 8px; margin-bottom: 15px;">
                <span class="widget-title" data-i18n="dua" style="border: none; margin: 0; padding: 0;">Dua of the Day</span>
            </div>
            <div id="dua-text" style="font-style:italic; text-align:center; color:var(--text-main); font-size: 1.15rem; line-height: 1.6; padding: 15px 0;">Loading...</div>
            <div id="dua-ref" style="color:var(--gold); font-size:0.85rem; margin-top:10px; width:100%; text-align:right; font-weight: bold;"></div>
        </article>

        <section id="install-card-section" class="card install-card card-item" style="padding: 30px;">
            <div class="widget-title" style="margin-bottom: 15px; border: none; font-size: 1.2rem;" data-i18n="getapp">Get the App</div>
            <p style="text-align: center; color: var(--text-muted); font-size: 0.95rem; margin-top: 0; margin-bottom: 20px;">Install Adhan Display on your home screen for quick offline access.</p>
            <button id="install-btn" class="btn-gold" style="width: auto; padding: 14px 40px; border-radius: 50px; font-size: 1rem;" data-i18n="install">Install App</button>
        </section>

    </main>

    <footer>
        <img src="images/adhan display muslim prayer times dashboard logo.png" alt="Logo" class="footer-logo" style="width: 80px; height: auto; opacity: 0.8; margin-bottom: 15px; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.5));">
        
        <nav class="footer-nav">
            <a href="#hero">Prayer Times</a>
            <a href="#tracker">Salah Tracker</a>
            <a href="#quran-card">Quran Tracker</a>
            <a href="#qada-card">Missed Prayers</a>
            <a href="#ramadan-card">Ramadan Countdown</a>
            <a href="#qibla-card">Qibla Compass</a>
        </nav>
        
        <p style="font-size: 0.75rem; color: var(--text-muted); margin: 15px auto; max-width: 600px; line-height: 1.5; opacity: 0.7;">
            Adhan Display is a smart Islamic dashboard and prayer tracker. Track your daily Salah offline, find the Qibla direction, and read daily Quran verses and Hadiths.
        </p>

        <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 15px; letter-spacing: 0.5px;">Â© 2026 Adhan Display. Serving the Ummah.</p>
        
        <div style="display: flex; justify-content: center; gap: 25px; margin-bottom: 25px; flex-wrap: wrap;">
            <a href="https://instagram.com/adhandisplay" target="_blank" style="color: var(--gold); text-decoration: none; font-size: 0.95rem; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.036 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.487.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"/>
                </svg>
                @AdhanDisplay
            </a>

            <a href="https://x.com/adhandisplay" target="_blank" style="color: var(--gold); text-decoration: none; font-size: 0.95rem; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                </svg>
                @AdhanDisplay
            </a>
        </div>
        
        <div>
            <a href="https://buymeacoffee.com/kmni" target="_blank" style="text-decoration: none;">
                <button class="btn-gold" style="padding: 12px 30px; font-size: 0.9rem; border-radius: 50px; text-transform: none; display: inline-flex; width: auto; font-weight: bold; box-shadow: 0 4px 15px var(--shadow-color);">
                    â˜• Donate to keep this app ad-free
                </button>
            </a>
        </div>
    </footer>

    <script>
        const TRACK_PRAYERS = ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"];
        
        const i18n = {
            en: { subtitle: "The Ultimate Free Islamic Prayer Times & Qibla Dashboard", greg: "Gregorian", time: "Current Time", loc: "Location", hijri: "Hijri", curr: "Current Prayer", next: "Next Prayer In", ayah: "Ayah of the Day", hadith: "Hadith of the Day", dua: "Dua of the Day", qiyam: "Night Prayers", mid: "Midnight", tahajjud: "Tahajjud", allah: "Name of Allah", ramadan: "Ramadan", days: "Days Remaining", makkah: "Makkah Live", live_stream: "Holy Sites Live", watch: "Watch Stream", qibla: "Qibla Direction", north: "from true North", ar_find: "ğŸ§­ Open Qibla Compass", getapp: "Get the App", install: "Install App", pref: "Preferences", theme: "Theme Background", dynamic: "Dynamic", size: "Text Size", lang: "Language", nopray: "* Not permissible to pray *", audio_pref: "Audio & Alerts", wudu_alert: "10-Min Wudu Alert & Push", daily_source: "Daily Inspiration", sunnah_mon: "Sunnah Fasting: Monday", sunnah_thu: "Sunnah Fasting: Thursday", sunnah_white: "Sunnah Fasting: Ayyam al-Bid (White Days)", daily_times: "Daily Prayer Times", tracker_title: "Prayer Tracker Summary", last_7: "Last 7 Days:", last_30: "Last 30 Days:", past_days: "Past Days (Tap to Edit)", no_data: "No past data yet.", tasbih: "Digital Tasbih", resources: "Tools & Resources", revert_guide: "Step-by-Step Prayer Guide", zakat_calc: "Zakat Calculator", total_tracked: "Total Prayers Tracked:" },
            tr: { subtitle: "En Ä°yi Ãœcretsiz Ä°slami Namaz Vakitleri Panosu", greg: "Miladi", time: "Åu Anki Saat", loc: "Konum", hijri: "Hicri", curr: "Mevcut Namaz", next: "Sonraki Namaz", ayah: "GÃ¼nÃ¼n Ayeti", hadith: "GÃ¼nÃ¼n Hadisi", dua: "GÃ¼nÃ¼n DuasÄ±", qiyam: "Gece NamazlarÄ±", mid: "Gece YarÄ±sÄ±", tahajjud: "TeheccÃ¼d", allah: "Allah'Ä±n Ä°smi", ramadan: "Ramazan", days: "Kalan GÃ¼n", makkah: "Mekke CanlÄ±", live_stream: "Kutsal Yerler CanlÄ±", watch: "YayÄ±nÄ± Ä°zle", qibla: "KÄ±ble YÃ¶nÃ¼", north: "GerÃ§ek Kuzeyden", ar_find: "ğŸ§­ KÄ±ble PusulasÄ±nÄ± AÃ§", getapp: "UygulamayÄ± Al", install: "UygulamayÄ± YÃ¼kle", pref: "Tercihler", theme: "Tema", dynamic: "Dinamik", size: "Metin Boyutu", lang: "Dil", nopray: "* Namaz KÄ±lmak Mekruhtur *", audio_pref: "Ses ve UyarÄ±lar", wudu_alert: "10-Dk Abdest UyarÄ±sÄ±", daily_source: "GÃ¼nlÃ¼k Ä°lham", sunnah_mon: "SÃ¼nnet Orucu: Pazartesi", sunnah_thu: "SÃ¼nnet Orucu: PerÅŸembe", sunnah_white: "SÃ¼nnet Orucu: Eyyam-Ä± BÃ®d (Beyaz GÃ¼nler)", daily_times: "GÃ¼nlÃ¼k Namaz Vakitleri", tracker_title: "Namaz Takibi Ã–zeti", last_7: "Son 7 GÃ¼n:", last_30: "Son 30 GÃ¼n:", past_days: "GeÃ§miÅŸ GÃ¼nler", no_data: "HenÃ¼z veri yok.", tasbih: "Dijital Tesbih", resources: "AraÃ§lar ve Kaynaklar", revert_guide: "AdÄ±m AdÄ±m Namaz Rehberi", zakat_calc: "Zekat HesaplayÄ±cÄ±", total_tracked: "Toplam Takip Edilen Namaz:" },
            nl: { subtitle: "Het Ultieme Islamitische Gebedstijden Dashboard", greg: "Gregoriaans", time: "Huidige Tijd", loc: "Locatie", hijri: "Hidzjra", curr: "Huidig Gebed", next: "Volgend Gebed In", ayah: "Vers van de Dag", hadith: "Hadith van de Dag", dua: "Smeekbede van de Dag", qiyam: "Nachtgebeden", mid: "Middernacht", tahajjud: "Tahajjud", allah: "Naam van Allah", ramadan: "Ramadan", days: "Dagen Te Gaan", makkah: "Mekka Live", live_stream: "Heilige Plaatsen Live", watch: "Bekijk Stream", qibla: "Qibla Richting", north: "van ware noorden", ar_find: "ğŸ§­ Open Qibla Kompas", getapp: "Download de App", install: "Installeer App", pref: "Instellingen", theme: "Thema", dynamic: "Dynamisch", size: "Tekstgrootte", lang: "Taal", nopray: "* Bidden is niet toegestaan *", audio_pref: "Audio & Meldingen", wudu_alert: "10-Min Wudu Melding", daily_source: "Dagelijkse Inspiratie", sunnah_mon: "Sunnah Vasten: Maandag", sunnah_thu: "Sunnah Vasten: Donderdag", sunnah_white: "Sunnah Vasten: Witte Dagen", daily_times: "Dagelijkse Gebedstijden", tracker_title: "Gebedstracker Samenvatting", last_7: "Laatste 7 Dagen:", last_30: "Laatste 30 Dagen:", past_days: "Verleden Dagen", no_data: "Nog geen data.", tasbih: "Digitale Tasbih", resources: "Tools & Hulpbronnen", revert_guide: "Stap-voor-Stap Gebedsgids", zakat_calc: "Zakat Calculator", total_tracked: "Totaal Gevolgde Gebeden:" },
            fr: { subtitle: "Le Tableau de Bord Islamique Ultime", greg: "GrÃ©gorien", time: "Heure Actuelle", loc: "Emplacement", hijri: "HÃ©gire", curr: "PriÃ¨re Actuelle", next: "Prochaine PriÃ¨re", ayah: "Verset du Jour", hadith: "Hadith du Jour", dua: "Dua du Jour", qiyam: "PriÃ¨res Nocturnes", mid: "Minuit", tahajjud: "Tahajjud", allah: "Nom d'Allah", ramadan: "Ramadan", days: "Jours Restants", makkah: "Mecque en Direct", live_stream: "Lieux Saints en Direct", watch: "Regarder le Stream", qibla: "Direction de la Qibla", north: "du vrai nord", ar_find: "ğŸ§­ Ouvrir la Boussole Qibla", getapp: "Obtenir l'App", install: "Installer l'App", pref: "PrÃ©fÃ©rences", theme: "ThÃ¨me", dynamic: "Dynamique", size: "Taille du Texte", lang: "Langue", nopray: "* PriÃ¨re non permise *", audio_pref: "Audio & Alertes", wudu_alert: "Alerte Wudu 10-Min", daily_source: "Inspiration Quotidienne", sunnah_mon: "JeÃ»ne Sunnah : Lundi", sunnah_thu: "JeÃ»ne Sunnah : Jeudi", sunnah_white: "JeÃ»ne Sunnah : Jours Blancs", daily_times: "Heures de PriÃ¨re", tracker_title: "RÃ©sumÃ© des PriÃ¨res", last_7: "7 Derniers Jours:", last_30: "30 Derniers Jours:", past_days: "Jours PassÃ©s", no_data: "Aucune donnÃ©e.", tasbih: "Tasbih NumÃ©rique", resources: "Outils et Ressources", revert_guide: "Guide de PriÃ¨re Ã‰tape par Ã‰tape", zakat_calc: "Calculatrice de Zakat", total_tracked: "Total des PriÃ¨res Suivies:" },
            de: { subtitle: "Das Ultimative Islamische Dashboard", greg: "Gregorianisch", time: "Aktuelle Zeit", loc: "Ort", hijri: "Hidschra", curr: "Aktuelles Gebet", next: "NÃ¤chstes Gebet In", ayah: "Vers des Tages", hadith: "Hadith des Tages", dua: "Dua des Tages", qiyam: "Nachtgebete", mid: "Mitternacht", tahajjud: "Tahajjud", allah: "Name Allahs", ramadan: "Ramadan", days: "Verbleibende Tage", makkah: "Mekka Live", live_stream: "Heilige StÃ¤tten Live", watch: "Stream Ansehen", qibla: "Qibla-Richtung", north: "vom wahren Norden", ar_find: "ğŸ§­ Qibla-Kompass Ã–ffnen", getapp: "App Holen", install: "App Installieren", pref: "Einstellungen", theme: "Thema", dynamic: "Dynamisch", size: "TextgrÃ¶ÃŸe", lang: "Sprache", nopray: "* Beten ist nicht erlaubt *", audio_pref: "Audio & Warnungen", wudu_alert: "10-Min Wudu-Alarm", daily_source: "TÃ¤gliche Inspiration", sunnah_mon: "Sunnah Fasten: Montag", sunnah_thu: "Sunnah Fasten: Donnerstag", sunnah_white: "Sunnah Fasten: WeiÃŸe Tage", daily_times: "TÃ¤gliche Gebetszeiten", tracker_title: "Gebets-Tracker", last_7: "Letzte 7 Tage:", last_30: "Letzte 30 Tage:", past_days: "Vergangene Tage", no_data: "Noch keine Daten.", tasbih: "Digitaler Tasbih", resources: "Werkzeuge & Ressourcen", revert_guide: "Schritt-fÃ¼r-Schritt Gebetsanleitung", zakat_calc: "Zakat Rechner", total_tracked: "Verfolgte Gebete:" },
            es: { subtitle: "El Panel de OraciÃ³n IslÃ¡mica Definitivo", greg: "Gregoriano", time: "Hora Actual", loc: "UbicaciÃ³n", hijri: "HÃ©gira", curr: "OraciÃ³n Actual", next: "PrÃ³xima OraciÃ³n En", ayah: "VersÃ­culo del DÃ­a", hadith: "Hadiz del DÃ­a", dua: "Dua del DÃ­a", qiyam: "Oraciones Nocturnas", mid: "Medianoche", tahajjud: "Tahajjud", allah: "Nombre de AlÃ¡", ramadan: "RamadÃ¡n", days: "DÃ­as Restantes", makkah: "La Meca en Vivo", live_stream: "Lugares Santos en Vivo", watch: "Ver TransmisiÃ³n", qibla: "DirecciÃ³n Qibla", north: "desde el norte", ar_find: "ğŸ§­ Abrir BrÃºjula Qibla", getapp: "Obtener App", install: "Instalar App", pref: "Preferencias", theme: "Tema", dynamic: "DinÃ¡mico", size: "TamaÃ±o", lang: "Idioma", nopray: "* No estÃ¡ permitido orar *", audio_pref: "Audio y Alertas", wudu_alert: "Alerta Wudu 10-Min", daily_source: "InspiraciÃ³n Diaria", sunnah_mon: "Ayuno Sunnah: Lunes", sunnah_thu: "Ayuno Sunnah: Jueves", sunnah_white: "Ayuno Sunnah: DÃ­as Blancos", daily_times: "Horarios de OraciÃ³n", tracker_title: "Resumen de Oraciones", last_7: "Ãšltimos 7 DÃ­as:", last_30: "Ãšltimos 30 DÃ­as:", past_days: "DÃ­as Pasados", no_data: "AÃºn no hay datos.", tasbih: "Tasbih Digital", resources: "Herramientas y Recursos", revert_guide: "GuÃ­a de OraciÃ³n Paso a Paso", zakat_calc: "Calculadora de Zakat", total_tracked: "Oraciones Totales:" },
            ar: { subtitle: "Ù„ÙˆØ­Ø© Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©", greg: "Ù…ÙŠÙ„Ø§Ø¯ÙŠ", time: "Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ", loc: "Ø§Ù„Ù…ÙˆÙ‚Ø¹", hijri: "Ù‡Ø¬Ø±ÙŠ", curr: "Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©", next: "Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© ÙÙŠ", ayah: "Ø¢ÙŠØ© Ø§Ù„ÙŠÙˆÙ…", hadith: "Ø­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…", dua: "Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…", qiyam: "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", mid: "Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„", tahajjud: "ØªÙ‡Ø¬Ø¯", allah: "Ø§Ø³Ù… Ø§Ù„Ù„Ù‡", ramadan: "Ø±Ù…Ø¶Ø§Ù†", days: "Ø£ÙŠØ§Ù… Ù…ØªØ¨Ù‚ÙŠØ©", makkah: "Ù…ÙƒØ© Ù…Ø¨Ø§Ø´Ø±", live_stream: "Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ù‚Ø¯Ø³Ø©", watch: "Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¨Ø«", qibla: "Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©", north: "Ù…Ù† Ø§Ù„Ø´Ù…Ø§Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ", ar_find: "ğŸ§­ ÙØªØ­ Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ù‚Ø¨Ù„Ø©", getapp: "Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚", install: "ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚", pref: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", theme: "Ø§Ù„Ø³Ù…Ø©", dynamic: "Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ", size: "Ø­Ø¬Ù… Ø§Ù„Ù†Øµ", lang: "Ø§Ù„Ù„ØºØ©", nopray: "* Ø§Ù„ØµÙ„Ø§Ø© ØºÙŠØ± Ø¬Ø§Ø¦Ø²Ø© *", audio_pref: "Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª", wudu_alert: "ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆØ¶ÙˆØ¡ 10 Ø¯Ù‚Ø§Ø¦Ù‚", daily_source: "Ø¥Ù„Ù‡Ø§Ù… ÙŠÙˆÙ…ÙŠ", sunnah_mon: "ØµÙŠØ§Ù… Ø§Ù„Ø³Ù†Ø©: Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†", sunnah_thu: "ØµÙŠØ§Ù… Ø§Ù„Ø³Ù†Ø©: Ø§Ù„Ø®Ù…ÙŠØ³", sunnah_white: "ØµÙŠØ§Ù… Ø§Ù„Ø³Ù†Ø©: Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø¨ÙŠØ¶", daily_times: "Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©", tracker_title: "Ù…Ù„Ø®Øµ Ù…ØªØªØ¨Ø¹ Ø§Ù„ØµÙ„Ø§Ø©", last_7: "Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…:", last_30: "Ø¢Ø®Ø± 30 ÙŠÙˆÙ…:", past_days: "Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø§Ø¶ÙŠØ©", no_data: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯.", tasbih: "Ù…Ø³Ø¨Ø­Ø© Ø±Ù‚Ù…ÙŠØ©", resources: "Ø§Ù„Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯", revert_guide: "Ø¯Ù„ÙŠÙ„ Ø§Ù„ØµÙ„Ø§Ø© Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©", zakat_calc: "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø²ÙƒØ§Ø©", total_tracked: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙ„ÙˆØ§Øª Ø§Ù„Ù…ØªØ¹Ù‚Ø¨Ø©:" },
            id: { subtitle: "Papan Utama Waktu Shalat Islami", greg: "Masehi", time: "Waktu Saat Ini", loc: "Lokasi", hijri: "Hijriah", curr: "Shalat Saat Ini", next: "Shalat Berikutnya Dalam", ayah: "Ayat Hari Ini", hadith: "Hadits Hari Ini", dua: "Doa Hari Ini", qiyam: "Shalat Malam", mid: "Tengah Malam", tahajjud: "Tahajjud", allah: "Nama Allah", ramadan: "Ramadhan", days: "Hari Tersisa", makkah: "Makkah Live", live_stream: "Live Tempat Suci", watch: "Tonton Live", qibla: "Arah Kiblat", north: "dari Utara sebenarnya", ar_find: "ğŸ§­ Buka Kompas Kiblat", getapp: "Dapatkan Aplikasi", install: "Instal Aplikasi", pref: "Preferensi", theme: "Tema", dynamic: "Dinamis", size: "Ukuran Teks", lang: "Bahasa", nopray: "* Dilarang shalat *", audio_pref: "Audio & Peringatan", wudu_alert: "Peringatan Wudhu 10-Menit", daily_source: "Inspirasi Harian", sunnah_mon: "Puasa Sunnah: Senin", sunnah_thu: "Puasa Sunnah: Kamis", sunnah_white: "Puasa Sunnah: Ayyamul Bidh", daily_times: "Waktu Shalat Harian", tracker_title: "Ringkasan Pelacak", last_7: "7 Hari Terakhir:", last_30: "30 Hari Terakhir:", past_days: "Hari Sebelumnya", no_data: "Belum ada data.", tasbih: "Tasbih Digital", resources: "Alat & Sumber Daya", revert_guide: "Panduan Shalat", zakat_calc: "Kalkulator Zakat", total_tracked: "Total Shalat Tercatat:" },
            ur: { subtitle: "Ø§Ø³Ù„Ø§Ù…ÛŒ Ù†Ù…Ø§Ø² Ú©Û’ Ø§ÙˆÙ‚Ø§Øª Ú©Ø§ ÚˆÛŒØ´ Ø¨ÙˆØ±Úˆ", greg: "Ø¹ÛŒØ³ÙˆÛŒ", time: "Ù…ÙˆØ¬ÙˆØ¯Û ÙˆÙ‚Øª", loc: "Ù…Ù‚Ø§Ù…", hijri: "ÛØ¬Ø±ÛŒ", curr: "Ù…ÙˆØ¬ÙˆØ¯Û Ù†Ù…Ø§Ø²", next: "Ø§Ú¯Ù„ÛŒ Ù†Ù…Ø§Ø² Ù…ÛŒÚº", ayah: "Ø¢Ø¬ Ú©ÛŒ Ø¢ÛŒØª", hadith: "Ø¢Ø¬ Ú©ÛŒ Ø­Ø¯ÛŒØ«", dua: "Ø¢Ø¬ Ú©ÛŒ Ø¯Ø¹Ø§", qiyam: "Ù†Ù…Ø§Ø² ØªÛØ¬Ø¯", mid: "Ø¢Ø¯Ú¾ÛŒ Ø±Ø§Øª", tahajjud: "ØªÛØ¬Ø¯", allah: "Ø§Ù„Ù„Û Ú©Ø§ Ù†Ø§Ù…", ramadan: "Ø±Ù…Ø¶Ø§Ù†", days: "Ø¨Ø§Ù‚ÛŒ Ø¯Ù†", makkah: "Ù…Ú©Û Ù„Ø§Ø¦ÛŒÙˆ", live_stream: "Ù…Ù‚Ø¯Ø³ Ù…Ù‚Ø§Ù…Ø§Øª Ù„Ø§Ø¦ÛŒÙˆ", watch: "Ù„Ø§Ø¦ÛŒÙˆ Ø¯ÛŒÚ©Ú¾ÛŒÚº", qibla: "Ù‚Ø¨Ù„Û Ú©ÛŒ Ø³Ù…Øª", north: "Ø­Ù‚ÛŒÙ‚ÛŒ Ø´Ù…Ø§Ù„ Ø³Û’", ar_find: "ğŸ§­ Ù‚Ø¨Ù„Û Ú©Ù…Ù¾Ø§Ø³ Ú©Ú¾ÙˆÙ„ÛŒÚº", getapp: "Ø§ÛŒÙ¾ Ø­Ø§ØµÙ„ Ú©Ø±ÛŒÚº", install: "Ø§ÛŒÙ¾ Ø§Ù†Ø³Ù¹Ø§Ù„ Ú©Ø±ÛŒÚº", pref: "ØªØ±Ø¬ÛŒØ­Ø§Øª", theme: "ØªÚ¾ÛŒÙ…", dynamic: "Ù…ØªØ­Ø±Ú©", size: "Ù…ØªÙ† Ú©Ø§ Ø³Ø§Ø¦Ø²", lang: "Ø²Ø¨Ø§Ù†", nopray: "* Ù†Ù…Ø§Ø² Ù¾Ú‘Ú¾Ù†Ø§ Ù…Ù†Ø¹ ÛÛ’ *", audio_pref: "Ø¢ÚˆÛŒÙˆ Ø§ÙˆØ± Ø§Ù„Ø±Ù¹Ø³", wudu_alert: "10 Ù…Ù†Ù¹ ÙˆØ¶Ùˆ Ø§Ù„Ø±Ù¹", daily_source: "Ø±ÙˆØ²Ø§Ù†Û Ú©ÛŒ ØªØ­Ø±ÛŒÚ©", sunnah_mon: "Ø³Ù†Øª Ø±ÙˆØ²Û: Ù¾ÛŒØ±", sunnah_thu: "Ø³Ù†Øª Ø±ÙˆØ²Û: Ø¬Ù…Ø¹Ø±Ø§Øª", sunnah_white: "Ø³Ù†Øª Ø±ÙˆØ²Û: Ø§ÛŒØ§Ù… Ø¨ÛŒØ¶", daily_times: "Ø±ÙˆØ²Ø§Ù†Û Ù†Ù…Ø§Ø² Ú©Û’ Ø§ÙˆÙ‚Ø§Øª", tracker_title: "Ù†Ù…Ø§Ø² Ù¹Ø±ÛŒÚ©Ø± Ú©Ø§ Ø®Ù„Ø§ØµÛ", last_7: "Ø¢Ø®Ø±ÛŒ 7 Ø¯Ù†:", last_30: "Ø¢Ø®Ø±ÛŒ 30 Ø¯Ù†:", past_days: "Ù¾Ú†Ú¾Ù„Û’ Ø¯Ù†", no_data: "Ú©ÙˆØ¦ÛŒ ÚˆÛŒÙ¹Ø§ Ù†ÛÛŒÚºÛ”", tasbih: "ÚˆÛŒØ¬ÛŒÙ¹Ù„ ØªØ³Ø¨ÛŒØ­", resources: "Ù¹ÙˆÙ„Ø² Ø§ÙˆØ± ÙˆØ³Ø§Ø¦Ù„", revert_guide: "Ù†Ù…Ø§Ø² Ú©Ø§ Ø·Ø±ÛŒÙ‚Û", zakat_calc: "Ø²Ú©ÙˆÙ°Ûƒ Ú©ÛŒÙ„Ú©ÙˆÙ„ÛŒÙ¹Ø±", total_tracked: "Ú©Ù„ Ù¹Ø±ÛŒÚ© Ú©ÛŒ Ú¯Ø¦ÛŒ Ù†Ù…Ø§Ø²ÛŒÚº:" },
            bn: { subtitle: "à¦‡à¦¸à¦²à¦¾à¦®à¦¿à¦• à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦¸à¦®à¦¯à¦¼ à¦¡à§à¦¯à¦¾à¦¶à¦¬à§‹à¦°à§à¦¡", greg: "à¦‡à¦‚à¦°à§‡à¦œà¦¿", time: "à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦¸à¦®à¦¯à¦¼", loc: "à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨", hijri: "à¦¹à¦¿à¦œà¦°à¦¿", curr: "à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦¨à¦¾à¦®à¦¾à¦œ", next: "à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦¨à¦¾à¦®à¦¾à¦œ", ayah: "à¦†à¦œà¦•à§‡à¦° à¦†à¦¯à¦¼à¦¾à¦¤", hadith: "à¦†à¦œà¦•à§‡à¦° à¦¹à¦¾à¦¦à¦¿à¦¸", dua: "à¦†à¦œà¦•à§‡à¦° à¦¦à§‹à¦¯à¦¼à¦¾", qiyam: "à¦°à¦¾à¦¤à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ", mid: "à¦®à¦§à§à¦¯à¦°à¦¾à¦¤", tahajjud: "à¦¤à¦¾à¦¹à¦¾à¦œà§à¦œà§à¦¦", allah: "à¦†à¦²à§à¦²à¦¾à¦¹à¦° à¦¨à¦¾à¦®", ramadan: "à¦°à¦®à¦œà¦¾à¦¨", days: "à¦¦à¦¿à¦¨ à¦¬à¦¾à¦•à¦¿", makkah: "à¦®à¦•à§à¦•à¦¾ à¦²à¦¾à¦‡à¦­", live_stream: "à¦ªà¦¬à¦¿à¦¤à§à¦° à¦¸à§à¦¥à¦¾à¦¨ à¦²à¦¾à¦‡à¦­", watch: "à¦²à¦¾à¦‡à¦­ à¦¦à§‡à¦–à§à¦¨", qibla: "à¦•à¦¿à¦¬à¦²à¦¾à¦° à¦¦à¦¿à¦•", north: "à¦ªà§à¦°à¦•à§ƒà¦¤ à¦‰à¦¤à§à¦¤à¦° à¦¥à§‡à¦•à§‡", ar_find: "ğŸ§­ à¦•à¦¿à¦¬à¦²à¦¾ à¦•à¦®à§à¦ªà¦¾à¦¸ à¦–à§à¦²à§à¦¨", getapp: "à¦…à§à¦¯à¦¾à¦ªà¦Ÿà¦¿ à¦ªà¦¾à¦¨", install: "à¦…à§à¦¯à¦¾à¦ª à¦‡à¦¨à¦¸à§à¦Ÿà¦² à¦•à¦°à§à¦¨", pref: "à¦ªà¦›à¦¨à§à¦¦à¦¸à¦®à§‚à¦¹", theme: "à¦¥à¦¿à¦®", dynamic: "à¦¡à¦¾à¦‡à¦¨à¦¾à¦®à¦¿à¦•", size: "à¦Ÿà§‡à¦•à§à¦¸à¦Ÿ à¦¸à¦¾à¦‡à¦œ", lang: "à¦­à¦¾à¦·à¦¾", nopray: "* à¦¨à¦¾à¦®à¦¾à¦œ à¦ªà¦¡à¦¼à¦¾ à¦¨à¦¿à¦·à§‡à¦§ *", audio_pref: "à¦…à¦¡à¦¿à¦“ à¦à¦¬à¦‚ à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾", wudu_alert: "à§§à§¦-à¦®à¦¿à¦¨à¦¿à¦Ÿ à¦“à¦œà§ à¦¸à¦¤à¦°à§à¦•à¦¤à¦¾", daily_source: "à¦¦à§ˆà¦¨à¦¿à¦• à¦…à¦¨à§à¦ªà§à¦°à§‡à¦°à¦£à¦¾", sunnah_mon: "à¦¸à§à¦¨à§à¦¨à¦¾à¦¹ à¦°à§‹à¦œà¦¾: à¦¸à§‹à¦®à¦¬à¦¾à¦°", sunnah_thu: "à¦¸à§à¦¨à§à¦¨à¦¾à¦¹ à¦°à§‹à¦œà¦¾: à¦¬à§ƒà¦¹à¦¸à§à¦ªà¦¤à¦¿à¦¬à¦¾à¦°", sunnah_white: "à¦¸à§à¦¨à§à¦¨à¦¾à¦¹ à¦°à§‹à¦œà¦¾: à¦†à¦‡à¦¯à¦¼à¦¾à¦®à§‡ à¦¬à¦¿à¦œ", daily_times: "à¦¦à§ˆà¦¨à¦¿à¦• à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦¸à¦®à¦¯à¦¼", tracker_title: "à¦¨à¦¾à¦®à¦¾à¦œ à¦Ÿà§à¦°à§à¦¯à¦¾à¦•à¦¾à¦° à¦¸à¦¾à¦°à¦¾à¦‚à¦¶", last_7: "à¦¶à§‡à¦· à§­ à¦¦à¦¿à¦¨:", last_30: "à¦¶à§‡à¦· à§©à§¦ à¦¦à¦¿à¦¨:", past_days: "à¦…à¦¤à§€à¦¤à§‡à¦° à¦¦à¦¿à¦¨à¦—à§à¦²à§‹", no_data: "à¦•à§‹à¦¨à§‹ à¦¡à§‡à¦Ÿà¦¾ à¦¨à§‡à¦‡à¥¤", tasbih: "à¦¡à¦¿à¦œà¦¿à¦Ÿà¦¾à¦² à¦¤à¦¸à¦¬à¦¿à¦¹", resources: "à¦Ÿà§à¦²à¦¸ à¦à¦¬à¦‚ à¦°à¦¿à¦¸à§‹à¦°à§à¦¸", revert_guide: "à¦¨à¦¾à¦®à¦¾à¦œ à¦ªà¦¡à¦¼à¦¾à¦° à¦¨à¦¿à¦¯à¦¼à¦®", zakat_calc: "à¦¯à¦¾à¦•à¦¾à¦¤ à¦•à§à¦¯à¦¾à¦²à¦•à§à¦²à§‡à¦Ÿà¦°", total_tracked: "à¦®à§‹à¦Ÿ à¦Ÿà§à¦°à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¨à¦¾à¦®à¦¾à¦œ:" },
            ru: { subtitle: "Ğ˜ÑĞ»Ğ°Ğ¼ÑĞºĞ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ½Ğ°Ğ¼Ğ°Ğ·Ğ°", greg: "Ğ“Ñ€Ğ¸Ğ³Ğ¾Ñ€Ğ¸Ğ°Ğ½ÑĞºĞ¸Ğ¹", time: "Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ", loc: "ĞœĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ", hijri: "Ğ¥Ğ¸Ğ´Ğ¶Ñ€Ğ°", curr: "Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ½Ğ°Ğ¼Ğ°Ğ·", next: "Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ½Ğ°Ğ¼Ğ°Ğ· Ñ‡ĞµÑ€ĞµĞ·", ayah: "ĞÑÑ‚ Ğ´Ğ½Ñ", hadith: "Ğ¥Ğ°Ğ´Ğ¸Ñ Ğ´Ğ½Ñ", dua: "Ğ”ÑƒĞ° Ğ´Ğ½Ñ", qiyam: "ĞĞ¾Ñ‡Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ»Ğ¸Ñ‚Ğ²Ñ‹", mid: "ĞŸĞ¾Ğ»Ğ½Ğ¾Ñ‡ÑŒ", tahajjud: "Ğ¢Ğ°Ñ…Ğ°Ğ´Ğ¶ÑƒĞ´", allah: "Ğ˜Ğ¼Ñ ĞĞ»Ğ»Ğ°Ñ…Ğ°", ramadan: "Ğ Ğ°Ğ¼Ğ°Ğ´Ğ°Ğ½", days: "ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ Ğ´Ğ½ĞµĞ¹", makkah: "ĞœĞµĞºĞºĞ° ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ ÑÑ„Ğ¸Ñ€", live_stream: "Ğ¡Ğ²ÑÑ‚Ñ‹Ğµ Ğ¼ĞµÑÑ‚Ğ° (ÑÑ„Ğ¸Ñ€)", watch: "Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ‚Ñ€Ğ°Ğ½ÑĞ»ÑÑ†Ğ¸Ñ", qibla: "ĞĞ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞšĞ¸Ğ±Ğ»Ñ‹", north: "Ğ¾Ñ‚ Ğ¸ÑÑ‚Ğ¸Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑĞµĞ²ĞµÑ€Ğ°", ar_find: "ğŸ§­ ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ¿Ğ°Ñ ĞšĞ¸Ğ±Ğ»Ñ‹", getapp: "Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ", install: "Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ", pref: "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸", theme: "Ğ¢ĞµĞ¼Ğ°", dynamic: "Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ", size: "Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ñ‚ĞµĞºÑÑ‚Ğ°", lang: "Ğ¯Ğ·Ñ‹Ğº", nopray: "* ĞœĞ¾Ğ»Ğ¸Ñ‚ÑŒÑÑ Ğ½Ğµ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¾ *", audio_pref: "ĞÑƒĞ´Ğ¸Ğ¾ Ğ¸ Ğ¾Ğ¿Ğ¾Ğ²ĞµÑ‰ĞµĞ½Ğ¸Ñ", wudu_alert: "10-Ğ¼Ğ¸Ğ½ Ğ¾Ğ¿Ğ¾Ğ²ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ¾ Ğ²ÑƒĞ´Ñƒ", daily_source: "Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğµ Ğ²Ğ´Ğ¾Ñ…Ğ½Ğ¾Ğ²ĞµĞ½Ğ¸Ğµ", sunnah_mon: "Ğ¡ÑƒĞ½Ğ½Ğ°-Ğ¿Ğ¾ÑÑ‚: ĞŸĞ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº", sunnah_thu: "Ğ¡ÑƒĞ½Ğ½Ğ°-Ğ¿Ğ¾ÑÑ‚: Ğ§ĞµÑ‚Ğ²ĞµÑ€Ğ³", sunnah_white: "Ğ¡ÑƒĞ½Ğ½Ğ°-Ğ¿Ğ¾ÑÑ‚: Ğ‘ĞµĞ»Ñ‹Ğµ Ğ´Ğ½Ğ¸", daily_times: "Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ½Ğ°Ğ¼Ğ°Ğ·Ğ°", tracker_title: "Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° Ñ‚Ñ€ĞµĞºĞµÑ€Ğ°", last_7: "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 7 Ğ´Ğ½ĞµĞ¹:", last_30: "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 30 Ğ´Ğ½ĞµĞ¹:", past_days: "ĞŸÑ€Ğ¾ÑˆĞ»Ñ‹Ğµ Ğ´Ğ½Ğ¸", no_data: "ĞŸĞ¾ĞºĞ° Ğ½ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….", tasbih: "Ğ¦Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ñ‚Ğ°ÑĞ±Ğ¸Ñ…", resources: "Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸ Ñ€ĞµÑÑƒÑ€ÑÑ‹", revert_guide: "ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğµ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾", zakat_calc: "ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ·Ğ°ĞºÑÑ‚Ğ°", total_tracked: "Ğ’ÑĞµĞ³Ğ¾ Ğ¾Ñ‚ÑĞ»ĞµĞ¶ĞµĞ½Ğ¾ Ğ¼Ğ¾Ğ»Ğ¸Ñ‚Ğ²:" }
        };

        const dailyHadiths = [
            { text: "Actions are according to intentions, and everyone will get what was intended.", ref: "Sahih al-Bukhari 1" },
            { text: "He who does not show mercy to people, Allah will not show mercy to him.", ref: "Sahih Muslim 2319" },
            { text: "Make things easy for the people, and do not make it difficult for them.", ref: "Sahih al-Bukhari 69" },
            { text: "A good word is charity.", ref: "Sahih al-Bukhari 2989" },
            { text: "Richness is not having many possessions, but richness is being content with oneself.", ref: "Sahih al-Bukhari 6446" },
            { text: "None of you truly believes until he loves for his brother what he loves for himself.", ref: "Sahih al-Bukhari 13" },
            { text: "The strong man is not the good wrestler, but the strong man is he who controls himself when he is angry.", ref: "Sahih al-Bukhari 6114" },
            { text: "Every religion has its distinct characteristic, and the distinct characteristic of Islam is modesty.", ref: "Ibn Majah 4181" },
            { text: "The most beloved of deeds to Allah are those that are most consistent, even if it is small.", ref: "Sahih al-Bukhari 6464" },
            { text: "Do not belittle any good deed, even meeting your brother with a cheerful face.", ref: "Sahih Muslim 2626" },
            { text: "The best among you are those who have the best manners and character.", ref: "Sahih al-Bukhari 6029" },
            { text: "Whoever believes in Allah and the Last Day should speak a good word or remain silent.", ref: "Sahih al-Bukhari 6018" },
            { text: "God is gentle and loves gentleness in all things.", ref: "Sahih al-Bukhari 6024" },
            { text: "A believer is not a fault-finder, a curser, an abuser, or a foul-mouthed person.", ref: "Jami` at-Tirmidhi 1977" },
            { text: "Seek knowledge from the cradle to the grave.", ref: "Islamic Proverb" },
            { text: "The believerâ€™s shade on the Day of Resurrection will be his charity.", ref: "Jami` at-Tirmidhi 1925" },
            { text: "Part of the perfection of a person's Islam is leaving what does not concern him.", ref: "Jami` at-Tirmidhi 2317" },
            { text: "Allah does not look at your forms and possessions, but He looks at your hearts and your deeds.", ref: "Sahih Muslim 2564" },
            { text: "When a man dies, his deeds come to an end except for three: ongoing charity, beneficial knowledge, or a righteous child who prays for him.", ref: "Sahih Muslim 1631" },
            { text: "The best of you are those who learn the Quran and teach it.", ref: "Sahih al-Bukhari 5027" },
            { text: "Purity is half of faith.", ref: "Sahih Muslim 223" },
            { text: "There is no disease that Allah has created, except that He also has created its treatment.", ref: "Sahih al-Bukhari 5678" },
            { text: "The upper hand is better than the lower hand (i.e. he who gives is better than he who takes).", ref: "Sahih al-Bukhari 1429" },
            { text: "Modesty brings nothing but good.", ref: "Sahih al-Bukhari 6117" },
            { text: "He who cheats us is not one of us.", ref: "Sahih Muslim 101" },
            { text: "Take advantage of five before five: your youth before your old age, your health before your illness, your wealth before your poverty, your free time before your preoccupation, and your life before your death.", ref: "Shu'ab al-Iman" },
            { text: "Whoever relieves a believerâ€™s distress of the distressful aspects of this world, Allah will rescue him from a difficulty of the difficulties of the Hereafter.", ref: "Sahih Muslim 2699" },
            { text: "A father gives his child nothing better than a good education.", ref: "Jami` at-Tirmidhi 1952" },
            { text: "Hell lies hidden behind evil desires, and Paradise lies hidden behind hardships.", ref: "Sahih al-Bukhari 6487" },
            { text: "Feed the hungry, visit the sick, and set free the captives.", ref: "Sahih al-Bukhari 5373" },
            { text: "By Allah, he does not believe! By Allah, he does not believe! By Allah, he does not believe! ... He whose neighbor is not safe from his evil.", ref: "Sahih al-Bukhari 6016" },
            { text: "The most perfect believer in faith is the one whose character is finest and who is kindest to his wife.", ref: "Jami` at-Tirmidhi 2612" },
            { text: "Whoever directs someone to a good, then he will have the reward equal to the doer of the action.", ref: "Sahih Muslim 1893" },
            { text: "Give the worker his wages before his sweat dries.", ref: "Sunan Ibn Majah 2443" },
            { text: "No companion of mine should tell me anything bad about another person.", ref: "Sunan Abi Dawud" },
            { text: "The true Muslim is the one from whose tongue and hands the Muslims are safe.", ref: "Sahih al-Bukhari 10" },
            { text: "Beware of suspicion, for suspicion is the worst of false tales.", ref: "Sahih al-Bukhari 6064" },
            { text: "Look at those who stand at a lower level than you but don't look at those who stand at a higher level than you, for this would make the favors conferred upon you by Allah insignificant in your eyes.", ref: "Sahih Muslim 2963" },
            { text: "Allah is Beautiful, He loves beauty.", ref: "Sahih Muslim 91" },
            { text: "Truthfulness leads to righteousness, and righteousness leads to Paradise.", ref: "Sahih al-Bukhari 6094" },
            { text: "A man follows the religion of his friend; so each one should consider whom he makes his friend.", ref: "Sunan Abi Dawud 4833" },
            { text: "The merciful will be shown mercy by the Most Merciful. Be merciful to those on the earth, and the One in the heavens will have mercy upon you.", ref: "Jami` at-Tirmidhi 1924" },
            { text: "Oppression will be a darkness on the Day of Resurrection.", ref: "Sahih al-Bukhari 2447" },
            { text: "Do not be people without minds of your own, saying that if others treat you well you will treat them well, and that if they do wrong you will do wrong.", ref: "Jami` at-Tirmidhi 2007" },
            { text: "Verily, Allah does not look to your faces and your wealth but He looks to your heart and to your deeds.", ref: "Sahih Muslim 2564" },
            { text: "If you guarantee me six things on your part I shall guarantee you Paradise : Speak the truth when you talk, keep a promise when you make it...", ref: "Musnad Ahmad" },
            { text: "Every act of goodness is charity.", ref: "Sahih Muslim 1005" },
            { text: "A person will be with those whom he loves.", ref: "Sahih al-Bukhari 6168" },
            { text: "The world is a prison for the believer and a paradise for the unbeliever.", ref: "Sahih Muslim 2956" },
            { text: "He who covers the faults of a Muslim, Allah will cover his faults in this world and the Hereafter.", ref: "Sahih Muslim 2699" },
            { text: "There is no reward for a Hajj Mabrur except Paradise.", ref: "Sahih al-Bukhari 1773" },
            { text: "The key to Paradise is Salah (prayer).", ref: "Jami` at-Tirmidhi 4" },
            { text: "O Allah, I seek refuge in You from anxiety and sorrow, weakness and laziness, miserliness and cowardice.", ref: "Sahih al-Bukhari 2893" },
            { text: "Do not sever relations. Do not turn your backs on each other. Do not entertain mutual hatred.", ref: "Sahih Muslim 2559" },
            { text: "When you see a person who has been given more than you in money and beauty, look to those who have been given less.", ref: "Sahih Muslim" },
            { text: "The greatest jihad is to battle your own soul, to fight the evil within yourself.", ref: "Ibn Majah" },
            { text: "Do not wish to be like anyone except in two cases: a man whom Allah has given wealth and he spends it righteously...", ref: "Sahih al-Bukhari 73" },
            { text: "Smiling at your brother is charity.", ref: "Tirmidhi" },
            { text: "Be mindful of Allah, you will find Him before you.", ref: "40 Hadith Nawawi 19" },
            { text: "Say, 'I believe in Allah' and then be steadfast.", ref: "Sahih Muslim 38" },
            { text: "When three of you are together, two of you must not converse privately ignoring the third.", ref: "Sahih Muslim 2183" },
            { text: "He is not a believer whose stomach is filled while the neighbor to his side goes hungry.", ref: "Sunan al-Kubra 19049" },
            { text: "Make things easy, and do not make them difficult. Give glad tidings, and do not put people off.", ref: "Sahih al-Bukhari 6125" },
            { text: "Whoever does not thank people has not thanked Allah.", ref: "Sunan Abi Dawud 4811" },
            { text: "Exchange gifts, as that will lead to increasing your love to one another.", ref: "Al-Adab Al-Mufrad 594" },
            { text: "Allah is mild and is fond of mildness, and He gives to the mild what he does not give to the harsh.", ref: "Sahih Muslim 2593" },
            { text: "He who traverses a path in search of knowledge, Allah will make easy for him the path to Paradise.", ref: "Sahih Muslim 2699" },
            { text: "The best wealth is a tongue that remembers Allah, a grateful heart, and a believing wife.", ref: "Sunan Ibn Majah 1856" },
            { text: "Keep away from envy, for it eats up good deeds just as fire eats up firewood.", ref: "Sunan Abi Dawud 4903" },
            { text: "A believer is simple and noble, while an evildoer is deceitful and ignoble.", ref: "Sunan Abi Dawud 4790" },
            { text: "No one has ever eaten better food than what he eats from the work done by his own hands.", ref: "Sahih al-Bukhari 2072" },
            { text: "The most beloved places to Allah are the mosques.", ref: "Sahih Muslim 671" },
            { text: "Seven people will be shaded by Allah under His shade on the day when there will be no shade except His...", ref: "Sahih al-Bukhari 660" },
            { text: "You will not enter Paradise until you believe, and you will not believe until you love one another.", ref: "Sahih Muslim 54" },
            { text: "Righteousness is good character.", ref: "Sahih Muslim 2553" },
            { text: "If the Hour (the day of Resurrection) is about to be established and one of you was holding a palm shoot, let him take advantage of even one second before the Hour is established to plant it.", ref: "Musnad Ahmad 12902" },
            { text: "Leave that which makes you doubt for that which does not make you doubt.", ref: "Jami` at-Tirmidhi 2518" },
            { text: "Do not let yourselves be 'yes-men', saying: 'If the people are good then we will be good, and if they are wrong then we will be wrong.'", ref: "Jami` at-Tirmidhi 2007" },
            { text: "Do not be angry, and Paradise will be yours.", ref: "Tabarani" },
            { text: "The strong man is he who controls himself when he is angry.", ref: "Sahih al-Bukhari 6114" },
            { text: "No fatigue, nor disease, nor sorrow, nor sadness, nor hurt, nor distress befalls a Muslim, even if it were the prick he receives from a thorn, but that Allah expiates some of his sins for that.", ref: "Sahih al-Bukhari 5641" },
            { text: "Whoever reads a letter from the Book of Allah, he will have a reward. And that reward will be multiplied by ten.", ref: "Jami` at-Tirmidhi 2910" },
            { text: "The supplication of a Muslim for his brother in his absence will certainly be answered.", ref: "Sahih Muslim 2732" },
            { text: "He who has in his heart the weight of a mustard seed of pride shall not enter Paradise.", ref: "Sahih Muslim 91" },
            { text: "The best among you are those who are best to their families.", ref: "Jami` at-Tirmidhi 3895" },
            { text: "Cleanliness is half of faith.", ref: "Sahih Muslim 223" },
            { text: "If anyone constantly seeks pardon (from Allah), Allah will appoint for him a way out of every distress.", ref: "Sunan Abi Dawud 1518" },
            { text: "Do not invoke curses on yourselves or on your children or on your possessions.", ref: "Sahih Muslim 3009" },
            { text: "A believer is friendly and sociable. There is no good in one who is neither friendly nor sociable.", ref: "Musnad Ahmad 9187" },
            { text: "He who keeps silent saves himself.", ref: "Jami` at-Tirmidhi 2501" },
            { text: "Be in this world as if you were a stranger or a traveler.", ref: "Sahih al-Bukhari 6416" },
            { text: "Verily, the religion is easy, and no one burdens himself in religion except that it overcomes him.", ref: "Sahih al-Bukhari 39" },
            { text: "The signs of a hypocrite are three: When he speaks, he lies; when he makes a promise, he breaks it; and when he is trusted, he betrays his trust.", ref: "Sahih al-Bukhari 33" },
            { text: "When you stand up for your prayer, pray as if it is your last prayer.", ref: "Sunan Ibn Majah 4171" },
            { text: "Fasting is a shield.", ref: "Sahih al-Bukhari 1894" },
            { text: "Whoever does not show mercy to our young ones, nor acknowledge the right of our elders, is not one of us.", ref: "Jami` at-Tirmidhi 1919" },
            { text: "Whoever covers (the faults of) a Muslim, Allah will cover his faults on the Day of Resurrection.", ref: "Sahih al-Bukhari 2442" },
            { text: "A person's true wealth is the good he does in this world to his fellow men.", ref: "Islamic Proverb" },
            { text: "The best giving is that which is given from the heart.", ref: "Islamic Proverb" },
            { text: "Speak good or remain silent.", ref: "Sahih al-Bukhari 6018" }
        ];

        const dailyDuas = [
            { text: "Rabbana atina fid-dunya hasanatan wa fil 'akhirati hasanatan waqina 'adhaban-nar\n(Our Lord, give us in this world [that which is] good and in the Hereafter [that which is] good and protect us from the punishment of the Fire.)", ref: "Quran 2:201" },
            { text: "Rabbi inni lima anzalta ilayya min khayrin faqir\n(My Lord, indeed I am, for whatever good You would send down to me, in need.)", ref: "Quran 28:24" },
            { text: "Ya Muqallibal-qulub, thabbit qalbi 'ala dinik\n(O Turner of the hearts, keep my heart firm upon Your religion.)", ref: "Tirmidhi" },
            { text: "Rabbi zidni 'ilma\n(My Lord, increase me in knowledge.)", ref: "Quran 20:114" },
            { text: "Astaghfirullahal-ladhi la ilaha illa Huwal-Hayyul-Qayyum wa atubu ilayh\n(I seek the forgiveness of Allah, there is no true god except Him, the Ever-Living, the Sustainer of existence, and I turn to Him in repentance.)", ref: "Tirmidhi" },
            { text: "Rabbighfir warham wa anta khayrur-rahimin\n(My Lord, forgive and have mercy, and You are the best of the merciful.)", ref: "Quran 23:118" },
            { text: "Rabbana la tuzigh qulubana ba'da idh hadaytana wa hab lana min ladunka rahmatan\n(Our Lord, let not our hearts deviate after You have guided us and grant us from Yourself mercy.)", ref: "Quran 3:8" },
            { text: "Rabbana hab lana min azwajina wa dhurriyyatina qurrata a'yunin waj'alna lil-muttaqina imama\n(Our Lord, grant us from among our wives and offspring comfort to our eyes and make us an example for the righteous.)", ref: "Quran 25:74" },
            { text: "Rabbana zalamna anfusana wa in lam taghfir lana wa tarhamna lanakunanna minal-khasirin\n(Our Lord, we have wronged ourselves, and if You do not forgive us and have mercy upon us, we will surely be among the losers.)", ref: "Quran 7:23" },
            { text: "Rabbi ishrah li sadri wa yassir li amri\n(My Lord, expand for me my breast [with assurance] and ease for me my task.)", ref: "Quran 20:25-26" },
            { text: "Rabbana afrigh 'alayna sabran wa thabbit aqdamana wansurna 'alal-qawmil-kafirin\n(Our Lord, pour upon us patience and plant firmly our feet and give us victory over the disbelieving people.)", ref: "Quran 2:250" },
            { text: "Rabbi awzi'ni an ashkura ni'matakal-lati an'amta 'alayya wa 'ala walidayya\n(My Lord, enable me to be grateful for Your favor which You have bestowed upon me and upon my parents.)", ref: "Quran 27:19" },
            { text: "Rabbi hab li min ladunka dhurriyyatan tayyibatan innaka sami'ud-du'a\n(My Lord, grant me from Yourself a good offspring. Indeed, You are the Hearer of supplication.)", ref: "Quran 3:38" },
            { text: "Rabbana-ghfir lana wa li-ikhwaninal-ladhina sabaquna bil-iman\n(Our Lord, forgive us and our brothers who preceded us in faith.)", ref: "Quran 59:10" },
            { text: "Rabbi-j'alni muqimas-salati wa min dhurriyyati Rabbana wa taqabbal du'a\n(My Lord, make me an establisher of prayer, and [many] from my descendants. Our Lord, and accept my supplication.)", ref: "Quran 14:40" },
            { text: "Rabbana taqabbal minna innaka Antas-Sami'ul-'Alim\n(Our Lord, accept [this] from us. Indeed You are the Hearing, the Knowing.)", ref: "Quran 2:127" },
            { text: "Hasbunallah wa ni'mal-wakil\n(Sufficient for us is Allah, and [He is] the best Disposer of affairs.)", ref: "Quran 3:173" },
            { text: "La ilaha illa anta subhanaka inni kuntu minaz-zalimin\n(There is no deity except You; exalted are You. Indeed, I have been of the wrongdoers.)", ref: "Quran 21:87" },
            { text: "Bismillahil-ladhi la yadurru ma'as-mihi shai'un fil-ardi wa la fis-sama'i wa huwas-Sami'ul-'Alim\n(In the Name of Allah with Whose Name there is protection against every kind of harm in the earth or in the heaven, and He is the All-Hearing and All-Knowing.)", ref: "Abu Dawud" },
            { text: "Raditu billahi Rabban wa bil-Islami dinan wa bi Muhammadin nabiyyan\n(I am pleased with Allah as my Lord, with Islam as my religion, and with Muhammad as my Prophet.)", ref: "Abu Dawud" },
            { text: "Allahumma inni as'alukal-huda wat-tuqa wal-'afafa wal-ghina\n(O Allah, I ask You for guidance, piety, chastity, and self-sufficiency.)", ref: "Muslim" },
            { text: "Allahumma inni a'udhu bika minal-hammi wal-hazan, wal-'ajzi wal-kasal, wal-bukhli wal-jubn\n(O Allah, I seek refuge in You from anxiety and sorrow, weakness and laziness, miserliness and cowardice.)", ref: "Bukhari" },
            { text: "Allahumma 'afini fi badani, Allahumma 'afini fi sam'i, Allahumma 'afini fi basari\n(O Allah, grant me health in my body. O Allah, grant me health in my hearing. O Allah, grant me health in my sight.)", ref: "Abu Dawud" },
            { text: "Allahumma inni as'aluka 'ilman nafi'an, wa rizqan tayyiban, wa 'amalan mutaqabbalan\n(O Allah, I ask You for beneficial knowledge, goodly provision, and acceptable deeds.)", ref: "Ibn Majah" },
            { text: "Ya Hayyu Ya Qayyum, bi-rahmatika astaghith, aslih li sha'ni kullahu\n(O Ever-Living, O Sustainer, in Your mercy I seek relief; rectify for me all of my affairs.)", ref: "Tirmidhi" },
            { text: "Allahumma rahmataka arju fala takilni ila nafsi tarfata 'aynin\n(O Allah, it is Your mercy that I hope for, so do not leave me in charge of my affairs even for a blink of an eye.)", ref: "Abu Dawud" },
            { text: "Allahumma ajirni minan-nar\n(O Allah, save me from the Fire.)", ref: "Abu Dawud" },
            { text: "Allahumma innaka 'afuwwun tuhibbul-'afwa fa'fu 'anni\n(O Allah, You are forgiving and love forgiveness, so forgive me.)", ref: "Tirmidhi" },
            { text: "Rabbi-ghfir li wa tub 'alayya innaka Antat-Tawwabur-Rahim\n(My Lord, forgive me and accept my repentance. Indeed, You are the Accepting of repentance, the Merciful.)", ref: "Abu Dawud" },
            { text: "Allahummaghfir li dhanbi kullahu, diqqahu wa jillahu, wa awwalahu wa akhirahu\n(O Allah, forgive me all my sins, the small and the great, the first and the last.)", ref: "Muslim" },
            { text: "Allahumma inni a'udhu bika min 'adhabi jahannam wa min 'adhabil-qabri\n(O Allah, I seek refuge in You from the punishment of Hell and from the punishment of the grave.)", ref: "Muslim" },
            { text: "Allahumma bika asbahna wa bika amsayna, wa bika nahya wa bika namut, wa ilaykan-nushur\n(O Allah, by You we enter the morning and by You we enter the evening, by You we live and by You we die, and to You is the Final Return.)", ref: "Tirmidhi" },
            { text: "Allahumma anta Rabbi la ilaha illa anta, khalaqtani wa ana 'abduka...\n(O Allah, You are my Lord, there is none worthy of worship but You. You created me and I am Your slave...)", ref: "Sayyid al-Istighfar (Bukhari)" },
            { text: "Subhanallahi wa bihamdihi, Subhanallahil-'Azim\n(Glory be to Allah and His is the praise, (and) Allah, the Greatest is free from imperfection.)", ref: "Bukhari" },
            { text: "La hawla wa la quwwata illa billah\n(There is no power and no strength except with Allah.)", ref: "Bukhari" },
            { text: "Allahumm-aslih li dini alladhi huwa 'ismatu amri, wa aslih li dunyaya allati fiha ma'ashi\n(O Allah, set right for me my religion which is the safeguard of my affairs. And set right for me my world in which is my life.)", ref: "Muslim" },
            { text: "Allahumma inni as'alukal-'afwa wal-'afiyata fid-dunya wal-akhirah\n(O Allah, I ask You for forgiveness and well-being in this world and in the Hereafter.)", ref: "Abu Dawud" },
            { text: "Allahumma a'inni 'ala dhikrika wa shukrika wa husni 'ibadatik\n(O Allah, help me to remember You, to thank You, and to worship You in the best of manners.)", ref: "Abu Dawud" },
            { text: "Rabbana atina min ladunka rahmatan wahayyi' lana min amrina rashada\n(Our Lord, grant us from Yourself mercy and prepare for us from our affair right guidance.)", ref: "Quran 18:10" },
            { text: "Rabbi fala taj'alni fil-qawmiz-zalimin\n(My Lord, then do not place me among the wrongdoing people.)", ref: "Quran 23:94" },
            { text: "Rabbana wasi'ta kulla shai'in rahmatan wa 'ilman faghfir lilladhina tabu\n(Our Lord, You have encompassed all things in mercy and knowledge, so forgive those who have repented.)", ref: "Quran 40:7" },
            { text: "Rabbana-ghfir lana dhunubana wa israfana fi amrina wa thabbit aqdamana\n(Our Lord, forgive us our sins and the excess [committed] in our affairs and plant firmly our feet.)", ref: "Quran 3:147" },
            { text: "Rabbi anilni hukman wa alhiqni bis-salihin\n(My Lord, grant me authority and join me with the righteous.)", ref: "Quran 26:83" },
            { text: "Rabbana asrif 'anna 'adhaba jahannama inna 'adhabaha kana gharama\n(Our Lord, avert from us the punishment of Hell. Indeed, its punishment is ever adhering.)", ref: "Quran 25:65" },
            { text: "Allahumma musarrifal-qulub, sarrif qulubana 'ala ta'atik\n(O Allah, Turner of the hearts, direct our hearts to Your obedience.)", ref: "Muslim" },
            { text: "Allahumma inni a'udhu bika min zawali ni'matik, wa tahawwuli 'afiyatik\n(O Allah, I seek refuge in You from the withholding of Your favor, the decline of the good health You have given.)", ref: "Muslim" },
            { text: "Allahumma aslih dhati baynina wa allif bayna qulubina wahdina subulas-salam\n(O Allah, reconcile between us, bring our hearts together, and guide us to the paths of peace.)", ref: "Abu Dawud" },
            { text: "Allahumm-akfini bihalalika 'an haramika wa aghnini bifadlika 'amman siwaka\n(O Allah, suffice me with Your lawful against Your unlawful, and make me independent of all those besides You.)", ref: "Tirmidhi" },
            { text: "Allahumma inni as'aluka husnal-khatimah\n(O Allah, I ask You for a good end to my life.)", ref: "General Dua" },
            { text: "Allahumma ij'al fi qalbi nuran wa fi basari nuran wa fi sam'i nuran\n(O Allah, place light in my heart, and light in my sight, and light in my hearing.)", ref: "Muslim" }
        ];

        // FIX: Safely parse old and new formats of Qada Data to prevent script crashing
        let rawQada = JSON.parse(localStorage.getItem('adhan_qada'));
        let qadaData = { Fajr: 0, Dhuhr: 0, Asr: 0, Maghrib: 0, Isha: 0 };
        if (rawQada) {
            if (rawQada.details) { 
                qadaData = { Fajr: rawQada.details.Fajr||0, Dhuhr: rawQada.details.Dhuhr||0, Asr: rawQada.details.Asr||0, Maghrib: rawQada.details.Maghrib||0, Isha: rawQada.details.Isha||0 }; 
            } else { 
                qadaData = { Fajr: rawQada.Fajr||0, Dhuhr: rawQada.Dhuhr||0, Asr: rawQada.Asr||0, Maghrib: rawQada.Maghrib||0, Isha: rawQada.Isha||0 }; 
            }
        }

        const customAudioDB = {
            async init() {
                return new Promise((resolve) => {
                    const req = indexedDB.open('AdhanAudioDB', 1);
                    req.onupgradeneeded = e => e.target.result.createObjectStore('audio');
                    req.onsuccess = e => resolve(e.target.result);
                });
            },
            async save(blob) {
                const db = await this.init();
                return new Promise(resolve => {
                    const tx = db.transaction('audio', 'readwrite');
                    tx.objectStore('audio').put(blob, 'custom_mp3');
                    tx.oncomplete = () => resolve();
                });
            },
            async get() {
                const db = await this.init();
                return new Promise(resolve => {
                    const req = db.transaction('audio').objectStore('audio').get('custom_mp3');
                    req.onsuccess = e => resolve(e.target.result);
                });
            }
        };

        const allCards = [
            { id: 'ramadan-card', name: 'Ramadan Tracker' },
            { id: 'hero', name: 'Prayer Times Hero' },
            { id: 'times-card', name: 'Daily Times' },
            { id: 'tracker', name: 'Prayer Tracker Summary' },
            { id: 'qada-card', name: 'Missed Prayers (Qada)' },
            { id: 'quran-card', name: 'Quran Tracker' },
            { id: 'events-card', name: 'Islamic Events' },
            { id: 'tools-card', name: 'Tools & Resources' },
            { id: 'video-card', name: 'Holy Sites Live' },
            { id: 'tasbih-card', name: 'Digital Tasbih' },
            { id: 'qibla-card', name: 'Qibla Compass' },
            { id: 'text-widget', name: 'Ayah / Hadith of the Day' },
            { id: 'dua-widget', name: 'Dua of the Day' },
            { id: 'night-widget', name: 'Night Prayers' },
            { id: 'names-widget', name: 'Name of Allah' }
        ];

        let config = { lat: 52.0907, lon: 5.1214, city: 'Netherlands', method: 3, offset: 0, hijriOffset: 0 };
        let state = { prayers: {}, monthlyCache: [], nextPrayer: null, prevPrayerTime: null, namesList: [], isRamadan: false, notified10Min: false, adhanPlayed: false, dailyAlertTriggered: false, tahajjudAlarmPlayed: false, qiblaDegree: 0 };
        let wakeLock = null;
        let isAutoLoc = localStorage.getItem('adhan_auto_loc') !== 'false';
        let autoLocationInterval = null;
        let inactivityTimer = null;

        const DOM = {};

        function processAutoQada() {
            const autoQadaEnabled = localStorage.getItem('adhan_auto_qada') !== 'false'; 
            if (!autoQadaEnabled) return;

            const now = new Date();
            // 4 AM cutoff so Isha doesn't get counted missed if user sleeps late
            const todayStrObj = new Date(now.getTime() - 4 * 3600000); 
            const todayStr = todayStrObj.getFullYear() + '-' + String(todayStrObj.getMonth() + 1).padStart(2, '0') + '-' + String(todayStrObj.getDate()).padStart(2, '0');

            let lastCalcDateStr = localStorage.getItem('adhan_last_qada_date');
            
            if (!lastCalcDateStr) {
                localStorage.setItem('adhan_last_qada_date', todayStr);
                return;
            }

            if (lastCalcDateStr === todayStr) return; 

            let qadaUpdated = false;
            let d = new Date(lastCalcDateStr);
            d.setDate(d.getDate() + 1); 

            const limit = new Date(todayStr);

            while (d <= limit) {
                let checkStr = d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
                if (checkStr === todayStr) break; 

                let dayRecord = prayerData[checkStr] || {};
                let isExempt = dayRecord.Exempt === true;

                if (!isExempt) {
                    TRACK_PRAYERS.forEach(p => {
                        if (!dayRecord[p]) {
                            qadaData[p] = (qadaData[p] || 0) + 1;
                            qadaUpdated = true;
                        }
                    });
                }
                d.setDate(d.getDate() + 1);
            }

            if (qadaUpdated) {
                localStorage.setItem('adhan_qada', JSON.stringify(qadaData));
                if (typeof renderQada === "function") renderQada();
            }
            
            localStorage.setItem('adhan_last_qada_date', todayStr);
        }

        async function requestWakeLock() {
            if ('wakeLock' in navigator) {
                try {
                    wakeLock = await navigator.wakeLock.request('screen');
                    wakeLock.addEventListener('release', () => { console.log('Screen Wake Lock released'); });
                } catch (err) { console.error(`${err.name}, ${err.message}`); }
            }
        }
        document.addEventListener('visibilitychange', async () => { if (document.visibilityState === 'visible') requestWakeLock(); });

        function resetInactivity() {
            document.body.classList.remove('ambient-active');
            if (inactivityTimer) clearTimeout(inactivityTimer);
            if (localStorage.getItem('adhan_screensaver') === 'true') {
                inactivityTimer = setTimeout(() => { document.body.classList.add('ambient-active'); }, 5 * 60 * 1000); 
            }
        }
        window.addEventListener('mousemove', resetInactivity);
        window.addEventListener('touchstart', resetInactivity);
        window.addEventListener('keydown', resetInactivity);

        function checkOnboarding() {
            if (!localStorage.getItem('adhan_onboarded')) {
                document.getElementById('onboarding-modal').classList.add('active');
            } else {
                applyGreeting();
            }
        }

        window.finishOnboarding = function(saveData) {
            if (saveData) {
                const name = document.getElementById('ob-name').value.trim();
                const year = document.getElementById('ob-year').value;
                const gender = document.getElementById('ob-gender').value;
                const bg = document.getElementById('ob-bg').value;

                if (name) localStorage.setItem('adhan_user_name', name);
                if (year) localStorage.setItem('adhan_user_year', year);
                if (gender) localStorage.setItem('adhan_user_gender', gender);
                if (bg) localStorage.setItem('adhan_user_bg', bg);
            }
            localStorage.setItem('adhan_onboarded', 'true');
            document.getElementById('onboarding-modal').classList.remove('active');
            applyGreeting();
        };

        function applyGreeting() {
            const name = localStorage.getItem('adhan_user_name');
            if (name && DOM.welcomeMessage) {
                DOM.welcomeMessage.innerText = `Welcome, ${name}`;
                DOM.welcomeMessage.style.display = 'block';
            }
        }

        function initUI() {
            DOM.liveClock = document.getElementById('live-clock');
            DOM.gregDate = document.getElementById('greg-date');
            DOM.hijriDate = document.getElementById('hijri-date');
            DOM.weather = document.getElementById('weather-display');
            DOM.locName = document.getElementById('location-name');
            DOM.currName = document.getElementById('curr-name');
            DOM.currTime = document.getElementById('curr-time');
            DOM.timerDisp = document.getElementById('timer-display');
            DOM.progress = document.getElementById('progress-fill');
            DOM.shuruqWarn = document.getElementById('shuruq-warning');
            DOM.welcomeMessage = document.getElementById('welcome-message');
            DOM.focusTimesList = document.getElementById('focus-times-list');
            DOM.jumuahBanner = document.getElementById('jumuah-banner');
            DOM.qQuranLink = document.getElementById('quran-link');
            DOM.qSpacer = document.getElementById('no-link-spacer');

            const settingsBtn = document.getElementById('settings-btn');
            const closeSettingsBtn = document.getElementById('close-settings');
            const settingsModal = document.getElementById('settings-modal');
            const focusBtn = document.getElementById('focus-btn');
            const fsBtn = document.getElementById('fullscreen-btn');

            function closeSettings() {
                settingsModal.classList.remove('active');
                const newMethod = document.getElementById('calc-method').value;
                const newOffset = document.getElementById('manual-offset').value;
                const newHijri = document.getElementById('hijri-offset').value;
                
                if (newMethod != config.method || newOffset != config.offset || newHijri != config.hijriOffset) {
                    config.method = newMethod;
                    config.offset = parseInt(newOffset) || 0;
                    config.hijriOffset = parseInt(newHijri) || 0;
                    
                    localStorage.setItem('adhan_method', config.method);
                    localStorage.setItem('adhan_offset', config.offset);
                    localStorage.setItem('adhan_hijri_offset', config.hijriOffset);
                    localStorage.removeItem(`calendar_${config.lat}_${config.lon}`);
                    fetchPrayerData();
                }
            }

            settingsBtn.addEventListener('click', () => settingsModal.classList.add('active'));
            closeSettingsBtn.addEventListener('click', closeSettings);
            
            settingsModal.addEventListener('click', (e) => {
                if (e.target === settingsModal) {
                    closeSettings();
                }
            });

            focusBtn.addEventListener('click', () => {
                document.body.classList.toggle('focus-mode');
                if(document.body.classList.contains('focus-mode')) window.scrollTo(0,0);
            });
            if(fsBtn) {
                fsBtn.addEventListener('click', () => {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => console.log(err));
                    } else {
                        if (document.exitFullscreen) document.exitFullscreen();
                    }
                });
            }
            
            document.getElementById('adhan-volume').addEventListener('input', (e) => {
                const vol = parseFloat(e.target.value);
                localStorage.setItem('adhan_volume', vol);
                document.querySelectorAll('audio').forEach(a => a.volume = vol);
            });

            document.getElementById('custom-bg-upload').addEventListener('change', (event) => {
                const file = event.target.files[0];
                if(!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const MAX_WIDTH = 1920; const MAX_HEIGHT = 1080;
                        let width = img.width; let height = img.height;

                        if (width > height && width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; } 
                        else if (height > MAX_HEIGHT) { width *= MAX_HEIGHT / height; height = MAX_HEIGHT; }
                        
                        canvas.width = width; canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.6); 
                        
                        try {
                            localStorage.setItem('adhan_custom_bg', dataUrl);
                            document.querySelectorAll('.theme-btn').forEach(b => b.classList.toggle('active', b.dataset.themeVal === 'custom'));
                            localStorage.setItem('adhan_theme', 'custom');
                            applySettings();
                        } catch(err) {
                            alert("Image too large to save. Try a smaller image.");
                        }
                    }
                    img.src = e.target.result;
                }
                reader.readAsDataURL(file);
            });

            document.getElementById('custom-adhan-upload').addEventListener('change', async (event) => {
                const file = event.target.files[0];
                if(!file) return;
                await customAudioDB.save(file);
                document.getElementById('custom-audio-status').innerText = `Saved: ${file.name}`;
                localStorage.setItem('adhan_audio', 'custom');
                applySettings();
            });

            initQuranTracker();
            renderQada();
        }

        function renderWidgetToggles() {
            const hiddenWidgets = JSON.parse(localStorage.getItem('adhan_hidden_widgets')) || [];
            let html = '';
            allCards.forEach(card => {
                const isHidden = hiddenWidgets.includes(card.id);
                html += `
                <label class="toggle-row" style="padding: 10px; border-color: rgba(255,255,255,0.1);">
                    <span style="font-size: 0.9rem;">${card.name}</span>
                    <input type="checkbox" onchange="toggleWidget('${card.id}', this.checked)" ${!isHidden ? 'checked' : ''} style="accent-color: var(--gold); transform: scale(1.3);">
                </label>`;
                
                const el = document.getElementById(card.id);
                if(el) {
                    if (isHidden) el.classList.add('hidden-widget');
                    else el.classList.remove('hidden-widget');
                }
            });
            document.getElementById('widget-toggles-list').innerHTML = html;
        }

        window.toggleWidget = function(id, isVisible) {
            let hiddenWidgets = JSON.parse(localStorage.getItem('adhan_hidden_widgets')) || [];
            if(!isVisible && !hiddenWidgets.includes(id)) { hiddenWidgets.push(id); }
            else if(isVisible) { hiddenWidgets = hiddenWidgets.filter(w => w !== id); }
            localStorage.setItem('adhan_hidden_widgets', JSON.stringify(hiddenWidgets));
            
            const el = document.getElementById(id);
            if(el) {
                if (!isVisible) el.style.display = 'none';
                else el.style.display = '';
            }
        };

        function applyWidgetVisibility() {
            const hiddenWidgets = JSON.parse(localStorage.getItem('adhan_hidden_widgets')) || [];
            allCards.forEach(card => {
                const el = document.getElementById(card.id);
                if (el && hiddenWidgets.includes(card.id)) el.style.display = 'none';
                else if(el) el.style.display = '';
            });
        }

        window.exportBackupJSON = function() {
            const backup = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('adhan_') && key !== 'adhan_custom_bg') {
                    backup[key] = localStorage.getItem(key);
                }
            }
            const blob = new Blob([JSON.stringify(backup)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `AdhanDisplay_Backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        };

        window.importBackupJSON = function(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    for (const key in data) { localStorage.setItem(key, data[key]); }
                    alert("Backup restored successfully! The page will now reload.");
                    location.reload();
                } catch(err) { alert("Invalid backup file."); }
            };
            reader.readAsText(file);
        };

        window.exportPrayerData = function() {
            let csvContent = "--- PRAYER & FASTING TRACKER ---\n";
            csvContent += "Date,Fajr,Dhuhr,Asr,Maghrib,Isha,Fasted,Kahf,Exempt\n";
            
            const data = JSON.parse(localStorage.getItem('adhan_tracker')) || {};
            const dates = Object.keys(data).sort();
            
            if (dates.length === 0) {
                csvContent += "No prayer data yet.\n";
            } else {
                dates.forEach(date => {
                    const p = data[date];
                    let row = [
                        date,
                        p.Fajr ? 'Yes' : 'No',
                        p.Dhuhr ? 'Yes' : 'No',
                        p.Asr ? 'Yes' : 'No',
                        p.Maghrib ? 'Yes' : 'No',
                        p.Isha ? 'Yes' : 'No',
                        p.Fast ? 'Yes' : 'No',
                        p.Kahf ? 'Yes' : 'No',
                        p.Exempt ? 'Yes' : 'No'
                    ];
                    csvContent += row.join(",") + "\n";
                });
            }
            csvContent += "\n";

            csvContent += "--- MISSED PRAYERS (QADA) ---\n";
            csvContent += "Prayer,Missed Count\n";
            Object.keys(qadaData).forEach(p => { csvContent += `${p},${qadaData[p]}\n`; });
            csvContent += "\n";

            const quran = JSON.parse(localStorage.getItem('adhan_quran')) || { surah: '', ayah: '' };
            csvContent += "--- QURAN READING TRACKER ---\n";
            csvContent += "Surah,Ayah\n";
            csvContent += `"${quran.surah}","${quran.ayah}"\n\n`;

            const locs = JSON.parse(localStorage.getItem('adhan_saved_locs')) || [];
            csvContent += "--- SAVED LOCATIONS ---\n";
            csvContent += "Name,Latitude,Longitude\n";
            if(locs.length === 0) { csvContent += "No saved locations.\n"; } 
            else { locs.forEach(l => { csvContent += `"${l.name}",${l.lat},${l.lon}\n`; }); }
            csvContent += "\n";

            const uName = localStorage.getItem('adhan_user_name') || 'N/A';
            const uYear = localStorage.getItem('adhan_user_year') || 'N/A';
            const uGender = localStorage.getItem('adhan_user_gender') || 'N/A';
            const uBg = localStorage.getItem('adhan_user_bg') || 'N/A';
            csvContent += "--- USER PROFILE ---\n";
            csvContent += "Name,Birth Year,Gender,Background\n";
            csvContent += `"${uName}","${uYear}","${uGender}","${uBg}"\n`;

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", "adhan_display_all_data.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };

        function applySettings() {
            const theme = localStorage.getItem('adhan_theme') || 'light';
            const lang = localStorage.getItem('adhan_lang') || 'en';
            const size = localStorage.getItem('adhan_size') || 'normal';
            const audio = localStorage.getItem('adhan_audio') || 'default';
            const source = localStorage.getItem('adhan_daily') || 'quran';
            const wudu = localStorage.getItem('adhan_wudu') === 'true';
            const dailyAlert = localStorage.getItem('adhan_daily_alert') === 'true';
            const vol = localStorage.getItem('adhan_volume') || 1;
            
            const autodim = localStorage.getItem('adhan_autodim') === 'true';
            const screensaver = localStorage.getItem('adhan_screensaver') === 'true';
            const tahajjud = localStorage.getItem('adhan_tahajjud_alarm') === 'true';
            const autoQada = localStorage.getItem('adhan_auto_qada') !== 'false'; 

            config.method = localStorage.getItem('adhan_method') || 3;
            config.offset = parseInt(localStorage.getItem('adhan_offset')) || 0;
            config.hijriOffset = parseInt(localStorage.getItem('adhan_hijri_offset')) || 0;

            document.documentElement.setAttribute('data-theme', theme);
            if (theme !== 'dynamic') document.documentElement.removeAttribute('data-time-of-day');

            document.getElementById('custom-bg-section').style.display = (theme === 'custom') ? 'block' : 'none';
            document.getElementById('custom-audio-section').style.display = (audio === 'custom') ? 'block' : 'none';

            if (theme === 'custom') {
                const customBg = localStorage.getItem('adhan_custom_bg');
                if (customBg) {
                    document.documentElement.style.setProperty('--bg-image', `url(${customBg})`);
                } else {
                    document.documentElement.style.removeProperty('--bg-image');
                }
            } else {
                document.documentElement.style.removeProperty('--bg-image');
            }

            let rootSize = '16px';
            if (size === 'small') rootSize = '14px';
            if (size === 'large') rootSize = '18px';
            document.documentElement.style.fontSize = rootSize;

            document.getElementById('wudu-toggle').checked = wudu;
            document.getElementById('daily-alert-toggle').checked = dailyAlert;
            document.getElementById('autodim-toggle').checked = autodim;
            document.getElementById('screensaver-toggle').checked = screensaver;
            document.getElementById('tahajjud-toggle').checked = tahajjud;
            document.getElementById('auto-qada-toggle').checked = autoQada;

            document.getElementById('calc-method').value = config.method;
            document.getElementById('manual-offset').value = config.offset;
            document.getElementById('hijri-offset').value = config.hijriOffset;
            document.getElementById('adhan-volume').value = vol;
            document.querySelectorAll('audio').forEach(a => a.volume = parseFloat(vol));

            if(source === 'hadith') {
                document.getElementById('daily-title').setAttribute('data-i18n', 'hadith');
                if(DOM.qQuranLink) DOM.qQuranLink.style.display = 'none';
                if(DOM.qSpacer) DOM.qSpacer.style.display = 'block';
            } else {
                document.getElementById('daily-title').setAttribute('data-i18n', 'ayah');
                if(DOM.qQuranLink) DOM.qQuranLink.style.display = 'flex';
                if(DOM.qSpacer) DOM.qSpacer.style.display = 'none';
            }

            document.querySelectorAll('.theme-btn').forEach(b => b.classList.toggle('active', b.dataset.themeVal === theme));
            document.getElementById('lang-select').value = lang;
            document.querySelectorAll('.text-btn').forEach(b => b.classList.toggle('active', b.dataset.sizeVal === size));
            document.querySelectorAll('.adhan-btn').forEach(b => b.classList.toggle('active', b.dataset.adhanVal === audio));
            document.querySelectorAll('.text-source-btn').forEach(b => b.classList.toggle('active', b.dataset.sourceVal === source));

            renderWidgetToggles();
            applyWidgetVisibility();
            applyTranslations(lang);
            resetInactivity();
        }

        function applyTranslations(lang) {
            document.documentElement.dir = (lang === 'ar' || lang === 'ur') ? 'rtl' : 'ltr';

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[lang] && i18n[lang][key]) el.innerText = i18n[lang][key];
                else if (i18n['en'][key]) el.innerText = i18n['en'][key];
            });
        }

        document.querySelectorAll('.theme-btn').forEach(btn => btn.addEventListener('click', (e) => { localStorage.setItem('adhan_theme', e.target.dataset.themeVal); applySettings(); updateDynamicTheme(); }));
        document.querySelectorAll('.text-btn').forEach(btn => btn.addEventListener('click', (e) => { localStorage.setItem('adhan_size', e.target.dataset.sizeVal); applySettings(); }));
        document.querySelectorAll('.adhan-btn').forEach(btn => btn.addEventListener('click', (e) => { localStorage.setItem('adhan_audio', e.target.dataset.adhanVal); applySettings(); }));
        document.querySelectorAll('.text-source-btn').forEach(btn => btn.addEventListener('click', (e) => { localStorage.setItem('adhan_daily', e.target.dataset.sourceVal); applySettings(); fetchContent(); }));
        
        document.getElementById('lang-select').addEventListener('change', (e) => { 
            localStorage.setItem('adhan_lang', e.target.value); 
            applySettings(); 
            fetchContent(); 
        });

        document.getElementById('wudu-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_wudu', e.target.checked); if(e.target.checked && "Notification" in window) Notification.requestPermission(); });
        document.getElementById('daily-alert-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_daily_alert', e.target.checked); if(e.target.checked && "Notification" in window) Notification.requestPermission(); });
        document.getElementById('tahajjud-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_tahajjud_alarm', e.target.checked); if(e.target.checked && "Notification" in window) Notification.requestPermission(); });
        document.getElementById('autodim-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_autodim', e.target.checked); applySettings(); });
        document.getElementById('screensaver-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_screensaver', e.target.checked); resetInactivity(); });
        document.getElementById('auto-qada-toggle').addEventListener('change', (e) => { localStorage.setItem('adhan_auto_qada', e.target.checked); if(e.target.checked) processAutoQada(); });

        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            document.getElementById('install-card-section').style.display = 'none';
        }

        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => { 
            e.preventDefault(); 
            deferredPrompt = e; 
        });
        const isIos = () => { return /iphone|ipad|ipod/.test( window.navigator.userAgent.toLowerCase() ); };

        document.getElementById('install-btn').addEventListener('click', async () => {
            if (deferredPrompt) { 
                await deferredPrompt.prompt(); 
                deferredPrompt = null; 
            } 
            else if (isIos()) { alert("To install on iOS: Tap the 'Share' icon at the bottom of Safari, scroll down, and select 'Add to Home Screen'."); } 
            else { alert("Tap your browser's menu (â‹®) and select 'Install' or 'Add to Home Screen'."); }
        });

        async function fetchCached(key, url, ttlHours) {
            const cached = localStorage.getItem(key);
            if (cached) {
                const parsed = JSON.parse(cached);
                if (Date.now() - parsed.timestamp < ttlHours * 3600000) return parsed.data;
            }
            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error("Network error");
                const data = await res.json();
                localStorage.setItem(key, JSON.stringify({ timestamp: Date.now(), data }));
                return data;
            } catch (e) {
                if (cached) return JSON.parse(cached).data;
                return null;
            }
        }

        let savedLocs = JSON.parse(localStorage.getItem('adhan_saved_locs')) || [];
        
        function renderLocations() {
            const container = document.getElementById('location-list');
            let htmlStr = `<div style="display: flex; gap: 8px; margin-bottom: 5px;">
                <button class="opt-btn ${isAutoLoc ? 'active' : ''}" style="flex:1;" onclick="enableAutoLocation()">ğŸ“ Auto Detect</button>
            </div>`;

            savedLocs.forEach((loc, index) => {
                const isActive = (!isAutoLoc && config.city === loc.name) ? 'active' : '';
                htmlStr += `<div style="display: flex; gap: 8px; margin-top: 8px;">
                    <button class="opt-btn ${isActive}" style="flex:1;" onclick="selectLocation(${index})">${loc.name}</button>
                    <button class="opt-btn" style="flex:0 0 auto; max-width: 45px;" onclick="editLocation(${index})" title="Edit">âœï¸</button>
                    <button class="opt-btn" style="flex:0 0 auto; max-width: 45px;" onclick="deleteLocation(${index})" title="Delete">ğŸ—‘ï¸</button>
                </div>`;
            });
            container.innerHTML = htmlStr;
        }

        window.enableAutoLocation = function() {
            isAutoLoc = true; localStorage.setItem('adhan_auto_loc', 'true');
            if(DOM.locName) DOM.locName.innerText = "Detecting...";
            renderLocations(); detectAndApplyAutoLocation(); startAutoLocationInterval();
        };
        
        window.selectLocation = function(index) {
            isAutoLoc = false; localStorage.setItem('adhan_auto_loc', 'false'); stopAutoLocationInterval();
            const loc = savedLocs[index]; config.lat = loc.lat; config.lon = loc.lon; config.city = loc.name;
            if(DOM.locName) DOM.locName.innerText = config.city;
            fetchWeather(); fetchPrayerData(); renderLocations(); calculateQibla();
        }

        window.editLocation = function(index) {
            const newName = prompt("Enter a new display name for this location:", savedLocs[index].name);
            if(newName && newName.trim() !== "") {
                const wasActive = (!isAutoLoc && config.city === savedLocs[index].name);
                savedLocs[index].name = newName.trim(); localStorage.setItem('adhan_saved_locs', JSON.stringify(savedLocs));
                if(wasActive) { config.city = savedLocs[index].name; if(DOM.locName) DOM.locName.innerText = config.city; }
                renderLocations();
            }
        };

        window.deleteLocation = function(index) {
            if(confirm("Are you sure you want to remove '" + savedLocs[index].name + "'?")) {
                const wasActive = (!isAutoLoc && config.city === savedLocs[index].name);
                savedLocs.splice(index, 1); localStorage.setItem('adhan_saved_locs', JSON.stringify(savedLocs));
                if(wasActive) window.enableAutoLocation(); else renderLocations();
            }
        };

        async function addManualLocation() {
            const name = document.getElementById('new-loc-name').value;
            if(!name) return;
            try {
                const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(name)}&count=1`);
                const data = await res.json();
                if(data.results && data.results.length > 0) {
                    savedLocs.push({name: data.results[0].name, lat: data.results[0].latitude, lon: data.results[0].longitude});
                    localStorage.setItem('adhan_saved_locs', JSON.stringify(savedLocs));
                    document.getElementById('new-loc-name').value = ''; selectLocation(savedLocs.length - 1); 
                } else { alert("Location not found."); }
            } catch(e) { console.error(e); }
        }

        async function detectAndApplyAutoLocation() {
            const data = await fetchCached('adhan_location_auto', 'https://ipapi.co/json/', 2);
            if(data && data.latitude) { 
                config.lat = data.latitude; config.lon = data.longitude; config.city = data.city || data.country_name; 
                if(DOM.locName) DOM.locName.innerText = config.city + ' (Auto)';
            }
            fetchWeather(); fetchPrayerData(); calculateQibla();
        }

        function startAutoLocationInterval() {
            if (autoLocationInterval) clearInterval(autoLocationInterval);
            autoLocationInterval = setInterval(() => { localStorage.removeItem('adhan_location_auto'); detectAndApplyAutoLocation(); }, 2 * 60 * 60 * 1000);
        }
        function stopAutoLocationInterval() { if (autoLocationInterval) clearInterval(autoLocationInterval); autoLocationInterval = null; }

        async function initLocation() {
            if (isAutoLoc) { await detectAndApplyAutoLocation(); startAutoLocationInterval(); } 
            else if (savedLocs.length > 0) {
                let activeIndex = savedLocs.findIndex(l => l.name === config.city); if (activeIndex === -1) activeIndex = 0;
                config.lat = savedLocs[activeIndex].lat; config.lon = savedLocs[activeIndex].lon; config.city = savedLocs[activeIndex].name;
                if(DOM.locName) DOM.locName.innerText = config.city;
                fetchWeather(); fetchPrayerData(); calculateQibla();
            } else { window.enableAutoLocation(); }
            renderLocations();
        }

        function updateDynamicTheme() {
            if (localStorage.getItem('adhan_theme') !== 'dynamic') { document.documentElement.removeAttribute('data-time-of-day'); return; }
            let timeOfDay = 'night';
            if (state.nextPrayer) {
                if (state.nextPrayer.name === 'Sunrise') timeOfDay = 'fajr';
                else if (['Dhuhr', 'Asr', 'Maghrib'].includes(state.nextPrayer.name)) timeOfDay = 'day';
            }
            document.documentElement.setAttribute('data-time-of-day', timeOfDay);
        }

        window.previewAudio = async function(type, btnElement) { 
            document.querySelectorAll('audio').forEach(a => { a.pause(); a.currentTime = 0; }); 
            document.querySelectorAll('.preview-btn').forEach(b => { b.innerText = 'â–¶'; b.title = 'Play'; });

            if (type === 'custom') {
                const blob = await customAudioDB.get();
                if(!blob) { alert("Please upload a custom audio file first."); return; }
                const url = URL.createObjectURL(blob);
                const customAudio = new Audio(url);
                customAudio.volume = parseFloat(localStorage.getItem('adhan_volume') || 1);
                customAudio.play();
                btnElement.innerText = 'â¹'; btnElement.title = 'Stop';
                customAudio.onended = () => { btnElement.innerText = 'â–¶'; btnElement.title = 'Play'; };
                return;
            }

            const audioEl = document.getElementById('audio-' + type); const isPlaying = !audioEl.paused;
            if (!isPlaying && audioEl) { 
                audioEl.play().catch(e => console.log(e)); btnElement.innerText = 'â¹'; btnElement.title = 'Stop';
                audioEl.onended = () => { btnElement.innerText = 'â–¶'; btnElement.title = 'Play'; };
            }
        };

        async function playAudio(triggerType) {
            const audioPref = localStorage.getItem('adhan_audio') || 'default';
            if (triggerType === 'adhan' && audioPref !== 'none') {
                if (audioPref === 'custom') {
                    const blob = await customAudioDB.get();
                    if(blob) {
                        const url = URL.createObjectURL(blob);
                        const customAudio = new Audio(url);
                        customAudio.volume = parseFloat(localStorage.getItem('adhan_volume') || 1);
                        customAudio.play().catch(e => console.log(e));
                        return;
                    }
                }
                const audioEl = document.getElementById('audio-' + (audioPref === 'custom' ? 'default' : audioPref)) || document.getElementById('audio-default');
                audioEl.play().catch(e => console.log(e));
            } else if (triggerType === 'chime') { document.getElementById('audio-chime').play().catch(e => console.log(e)); }
        }

        window.setStream = function(type) {
            document.getElementById('btn-makkah').classList.toggle('active', type === 'makkah');
            document.getElementById('btn-madinah').classList.toggle('active', type === 'madinah');
            document.getElementById('stream-link').href = type === 'makkah' 
                ? 'https://www.youtube.com/results?search_query=makkah+live' 
                : 'https://www.youtube.com/results?search_query=madina+live';
        };

        window.countAdhkar = function(btn) {
            const max = parseInt(btn.getAttribute('data-max'));
            let current = parseInt(btn.getAttribute('data-current') || '0');
            if(current < max) {
                current++;
                btn.setAttribute('data-current', current);
                btn.innerText = `Tap to Count (${current}/${max})`;
                if(current === max) { btn.style.background = 'var(--success)'; btn.style.color = '#fff'; btn.style.borderColor = 'var(--success)'; }
                if(navigator.vibrate) navigator.vibrate(50);
            }
        };
        window.resetAllAdhkar = function() {
            document.querySelectorAll('.adhkar-counter').forEach(btn => {
                const max = btn.getAttribute('data-max');
                btn.setAttribute('data-current', '0');
                btn.innerText = `Tap to Count (0/${max})`;
                btn.style.background = 'transparent'; btn.style.color = 'var(--gold)'; btn.style.borderColor = 'var(--gold)';
            });
        };

        let tasbihCount = 0;
        window.incrementTasbih = function() {
            tasbihCount++; document.getElementById('tasbih-btn').innerText = tasbihCount;
            if (tasbihCount % 33 === 0) {
                if (navigator.vibrate) navigator.vibrate(200);
                document.getElementById('tasbih-btn').classList.add('glow');
                setTimeout(() => document.getElementById('tasbih-btn').classList.remove('glow'), 250);
            }
        };
        window.resetTasbih = function() { tasbihCount = 0; document.getElementById('tasbih-btn').innerText = 0; };

        function renderQada() {
            let html = '';
            let totalMissed = 0;
            TRACK_PRAYERS.forEach(p => { 
                totalMissed += qadaData[p];
                html += `<div style="display:flex; justify-content:space-between; align-items:center; padding: 10px; border-bottom: 1px solid var(--border-color); background: rgba(0,0,0,0.1); border-radius: 8px;">
                    <span style="font-weight:bold; color:var(--text-main); text-transform: uppercase; font-size: 0.9rem;">${p}</span>
                    <div style="display:flex; align-items:center; gap: 10px;">
                        <button class="opt-btn" style="min-width:35px; padding:5px; margin:0;" onclick="updateQada('${p}', -1)">-</button>
                        <span style="color:var(--gold); font-family:monospace; font-size:1.3rem; min-width:30px; text-align:center; font-weight:bold;">${qadaData[p]}</span>
                        <button class="opt-btn" style="min-width:35px; padding:5px; margin:0;" onclick="updateQada('${p}', 1)">+</button>
                    </div>
                </div>`;
            });
            document.getElementById('qada-list').innerHTML = html;
            
            const countEl = document.querySelector('#qada-count strong');
            if (countEl) countEl.innerText = totalMissed;
        }

        window.updateQada = function(prayer, delta) {
            qadaData[prayer] = Math.max(0, qadaData[prayer] + delta);
            localStorage.setItem('adhan_qada', JSON.stringify(qadaData));
            renderQada();
        };

        function initQuranTracker() {
            const data = JSON.parse(localStorage.getItem('adhan_quran')) || { surah: '', ayah: '' };
            document.getElementById('quran-surah').value = data.surah;
            document.getElementById('quran-ayah').value = data.ayah;
        }
        window.saveQuranProgress = function() {
            const surah = document.getElementById('quran-surah').value;
            const ayah = document.getElementById('quran-ayah').value;
            localStorage.setItem('adhan_quran', JSON.stringify({ surah, ayah }));
            document.getElementById('quran-status').innerText = 'Progress Saved!';
            setTimeout(() => { document.getElementById('quran-status').innerText = ''; }, 3000);
        };

        window.jumpToDate = function(targetDateStr) {
            const parts = targetDateStr.split('-');
            const targetDate = new Date(parts[0], parts[1] - 1, parts[2]);
            const today = new Date();
            today.setHours(0,0,0,0); targetDate.setHours(0,0,0,0);
            
            trackerOffsetDays = Math.round((targetDate - today) / 86400000);
            updateTrackerView();
            document.getElementById('times-card').scrollIntoView({ behavior: 'smooth' });
        };

        window.changeTrackerDate = async function(delta) { trackerOffsetDays += delta; await updateTrackerView(); }

        window.openMonthlyTimetable = function() {
            if(!state.monthlyCache || state.monthlyCache.length === 0) return;
            
            let html = `<tr><th>Day</th><th>Fajr</th><th>Sunrise</th><th>Dhuhr</th><th>Asr</th><th>Maghrib</th><th>Isha</th></tr>`;
            state.monthlyCache.forEach(day => {
                const date = day.date.gregorian.day;
                const t = day.timings;
                html += `<tr>
                    <td>${date}</td>
                    <td>${addOffsetToString(t.Fajr)}</td>
                    <td>${addOffsetToString(t.Sunrise)}</td>
                    <td>${addOffsetToString(t.Dhuhr)}</td>
                    <td>${addOffsetToString(t.Asr)}</td>
                    <td>${addOffsetToString(t.Maghrib)}</td>
                    <td>${addOffsetToString(t.Isha)}</td>
                </tr>`;
            });
            document.getElementById('monthly-table').innerHTML = html;
            
            let gridHtml = '';
            const daysOfWeek = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            daysOfWeek.forEach(d => gridHtml += `<div class="cal-header">${d}</div>`);
            
            const firstDayStr = state.monthlyCache[0].date.gregorian.date; 
            const parts = firstDayStr.split('-');
            const firstDateObj = new Date(parts[2], parts[1]-1, parts[0]);
            let startDay = firstDateObj.getDay(); 
            if(startDay === 0) startDay = 7; 
            
            for(let i=1; i<startDay; i++) { gridHtml += `<div></div>`; } 
            
            const today = new Date().getDate();
            state.monthlyCache.forEach(day => {
                const isToday = day.date.gregorian.day == today ? 'active' : '';
                gridHtml += `<div class="cal-day ${isToday}">
                    <div class="cal-greg">${day.date.gregorian.day}</div>
                    <div class="cal-hijri">${day.date.hijri.day}</div>
                </div>`;
            });
            document.getElementById('calendar-grid-container').innerHTML = gridHtml;

            document.getElementById('monthly-modal').classList.add('active');
        };

        window.toggleCalView = function(view) {
            document.getElementById('btn-cal-list').classList.toggle('active', view === 'list');
            document.getElementById('btn-cal-grid').classList.toggle('active', view === 'grid');
            document.getElementById('monthly-list-view').style.display = view === 'list' ? 'block' : 'none';
            document.getElementById('monthly-grid-view').style.display = view === 'grid' ? 'block' : 'none';
        }

        async function fetchPrayerData() {
            const now = new Date(); const month = now.getMonth() + 1; const year = now.getFullYear();
            
            const adjParam = config.hijriOffset !== 0 ? `&adjustment=${config.hijriOffset}` : '';
            const data = await fetchCached(`calendar_${config.lat}_${config.lon}_${config.hijriOffset}`, `https://api.aladhan.com/v1/calendar/${year}/${month}?latitude=${config.lat}&longitude=${config.lon}&method=${config.method}${adjParam}`, 720); 
            
            if(data && data.code === 200) {
                state.monthlyCache = data.data; 
                
                const todayData = state.monthlyCache[now.getDate() - 1]; 
                state.prayers = todayData.timings; 
                
                const h = todayData.date.hijri;
                let hDay = parseInt(h.day) + config.hijriOffset;
                if(hDay > 30) hDay -= 30; if(hDay < 1) hDay += 30; 
                const hMonth = parseInt(h.month.number);

                if(DOM.hijriDate) DOM.hijriDate.innerText = `${hDay} ${h.month.en} ${h.year}`;
                if(hMonth === 9) { state.isRamadan = true; activateRamadanMode(hDay); } 
                else { state.isRamadan = false; calcRamadanCountdown(hMonth, hDay); }
                
                updateIslamicEvents(hDay, hMonth);
                
                document.getElementById('midnight-time').innerText = addOffsetToString(state.prayers.Midnight); 
                document.getElementById('last-third-time').innerText = addOffsetToString(state.prayers.Lastthird);
                
                determinePrayerState(); updateDynamicTheme(); updateTrackerView();
            }
        }

        function updateIslamicEvents(hDay, hMonth) {
            const events = [
                { name: "Ashura", m: 1, d: 10 },
                { name: "Ramadan", m: 9, d: 1 },
                { name: "Eid al-Fitr", m: 10, d: 1 },
                { name: "Day of Arafah", m: 12, d: 9 },
                { name: "Eid al-Adha", m: 12, d: 10 }
            ];
            
            let html = '';
            events.forEach(ev => {
                let mDiff = ev.m - hMonth;
                if (mDiff < 0 || (mDiff === 0 && hDay > ev.d)) mDiff = (ev.m + 12) - hMonth;
                
                if (mDiff === 0 && hDay === ev.d) {
                    html += `<div style="display:flex; justify-content:space-between; padding: 12px; background: rgba(212,175,55,0.15); border-radius: 8px; border: 1px solid var(--gold);"><strong>${ev.name}</strong> <span style="color:var(--gold);">Is Today!</span></div>`;
                } else {
                    let daysLeft = Math.floor((mDiff * 29.5) + (ev.d - hDay));
                    if(daysLeft > 0) {
                        html += `<div style="display:flex; justify-content:space-between; align-items:center; padding: 12px; border-bottom: 1px solid var(--border-color); background: rgba(0,0,0,0.1); border-radius: 8px;">
                            <span style="font-weight: 500;">${ev.name}</span> 
                            <span style="color:var(--gold); font-family:monospace; font-size:1.1rem; font-weight:bold;">~${daysLeft} days</span>
                        </div>`;
                    }
                }
            });
            document.getElementById('events-list').innerHTML = html;
        }

        async function updateTrackerView() {
            const targetDate = new Date(); targetDate.setDate(targetDate.getDate() + trackerOffsetDays);
            const isoDateStr = targetDate.getFullYear() + '-' + String(targetDate.getMonth() + 1).padStart(2, '0') + '-' + String(targetDate.getDate()).padStart(2, '0');
            document.getElementById('trackerDate').innerText = isoDateStr;
            const timesList = document.getElementById('daily-times-list');
            
            if (state.monthlyCache && state.monthlyCache.length >= targetDate.getDate() && targetDate.getMonth() === new Date().getMonth()) {
                 const dayData = state.monthlyCache[targetDate.getDate() - 1];
                 renderPrayerTracker(dayData.timings, isoDateStr);
            } else {
                 timesList.innerHTML = '<div style="text-align: center; color: var(--danger); padding: 20px;">Please return to current month to sync offline data.</div>';
            }
            
            const isHaidh = localStorage.getItem('adhan_haidh_mode') === 'true';
            document.getElementById('haidh-btn').innerText = isHaidh ? 'ğŸ©¸ Exemption Mode: ON' : 'ğŸ©¸ Exemption Mode: OFF';
            document.getElementById('haidh-btn').style.background = isHaidh ? 'rgba(255,68,68,0.2)' : 'transparent';
            
            if(isHaidh) {
                document.getElementById('daily-times-list').style.display = 'none';
                document.getElementById('haidh-notice').style.display = 'block';
            } else {
                document.getElementById('daily-times-list').style.display = 'block';
                document.getElementById('haidh-notice').style.display = 'none';
            }
        }
        
        window.toggleHaidhMode = function() {
            const isHaidh = localStorage.getItem('adhan_haidh_mode') === 'true';
            localStorage.setItem('adhan_haidh_mode', !isHaidh);
            
            const d = new Date(); const todayStr = d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
            if(!prayerData[todayStr]) { prayerData[todayStr] = { Fajr: false, Dhuhr: false, Asr: false, Maghrib: false, Isha: false, Fast: false, Kahf: false }; }
            prayerData[todayStr].Exempt = !isHaidh;
            localStorage.setItem('adhan_tracker', JSON.stringify(prayerData));
            
            updateTrackerView();
            updateStatistics();
        };

        function renderPrayerTracker(timings, dateStr) {
            if (!prayerData[dateStr]) { prayerData[dateStr] = { Fajr: false, Dhuhr: false, Asr: false, Maghrib: false, Isha: false, Fast: false, Kahf: false, Exempt: false }; localStorage.setItem('adhan_tracker', JSON.stringify(prayerData)); }
            
            let htmlStr = '';
            const seq = ["Fajr", "Sunrise", "Dhuhr", "Asr", "Maghrib", "Isha"];
            
            seq.forEach(p => {
                const displayTime = addOffsetToString(timings[p]);
                if(p === "Sunrise") {
                    htmlStr += `<div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding: 12px 5px; margin-bottom: 4px;">
                        <span style="color: var(--danger); font-weight: bold; text-transform: uppercase; font-size: 0.85rem; flex: 1;">${p}</span>
                        <span style="color: var(--danger); font-family: 'Courier New', monospace; font-size: 1.25rem; font-weight: bold; text-align: right;">${displayTime}</span>
                        <div style="width: 35px; margin-left: 15px;"></div>
                    </div>`;
                } else {
                    const isChecked = prayerData[dateStr][p] ? 'checked' : '';
                    htmlStr += `<label style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding: 12px 5px; margin-bottom: 4px; cursor: pointer; transition: background 0.2s; border-radius: 6px;" onmouseover="this.style.background='rgba(255,255,255,0.03)'" onmouseout="this.style.background='transparent'">
                        <span style="color: var(--text-main); font-weight: bold; text-transform: uppercase; font-size: 0.85rem; flex: 1;">${p}</span>
                        <span style="color: var(--gold); font-family: 'Courier New', monospace; font-size: 1.25rem; font-weight: bold; text-align: right;">${displayTime}</span>
                        <div style="width: 35px; margin-left: 15px; display: flex; justify-content: flex-end;">
                            <input type="checkbox" id="chk_${p}" ${isChecked} onchange="togglePrayer('${p}', '${dateStr}')" style="transform: scale(1.5); margin: 0; accent-color: var(--gold); cursor: pointer;">
                        </div>
                    </label>`;
                }
            });

            const dObj = new Date(dateStr + 'T12:00:00'); 
            if(dObj.getDay() === 5) {
                const isKahf = prayerData[dateStr]['Kahf'] ? 'checked' : '';
                htmlStr += `<label style="display: flex; justify-content: space-between; align-items: center; padding: 15px 10px; margin-top: 10px; cursor: pointer; background: rgba(212, 175, 55, 0.1); border: 1px solid var(--gold); border-radius: 6px;">
                    <span style="color: var(--gold); font-weight: bold; font-size: 0.9rem;">ğŸ“– Read Surah Al-Kahf?</span>
                    <input type="checkbox" id="chk_Kahf" ${isKahf} onchange="togglePrayer('Kahf', '${dateStr}')" style="transform: scale(1.5); margin: 0; accent-color: var(--gold); cursor: pointer;">
                </label>`;
            }

            const isFasting = prayerData[dateStr]['Fast'] ? 'checked' : '';
            htmlStr += `<label style="display: flex; justify-content: space-between; align-items: center; padding: 15px 10px; margin-top: 10px; cursor: pointer; background: rgba(46, 204, 113, 0.1); border: 1px solid var(--success); border-radius: 6px;">
                <span style="color: var(--success); font-weight: bold; font-size: 0.9rem;">Fasting (Fard / Sunnah)?</span>
                <input type="checkbox" id="chk_Fast" ${isFasting} onchange="togglePrayer('Fast', '${dateStr}')" style="transform: scale(1.5); margin: 0; accent-color: var(--success); cursor: pointer;">
            </label>`;
            
            document.getElementById('daily-times-list').innerHTML = htmlStr;
            updateStatistics();
        }

        window.togglePrayer = function(prayerName, dateStr) {
            const isNowChecked = document.getElementById('chk_' + prayerName).checked;
            
            if (prayerName !== 'Fast' && prayerName !== 'Kahf' && prayerName !== 'Exempt') {
                const autoQadaEnabled = localStorage.getItem('adhan_auto_qada') !== 'false';
                if (autoQadaEnabled) {
                    const now = new Date();
                    const todayStrObj = new Date(now.getTime() - 4 * 3600000); 
                    const todayStr = todayStrObj.getFullYear() + '-' + String(todayStrObj.getMonth() + 1).padStart(2, '0') + '-' + String(todayStrObj.getDate()).padStart(2, '0');
                    
                    if (dateStr < todayStr) {
                        const wasChecked = prayerData[dateStr] ? prayerData[dateStr][prayerName] : false;
                        if (isNowChecked && !wasChecked) {
                            qadaData[prayerName] = Math.max(0, (qadaData[prayerName] || 0) - 1);
                        } else if (!isNowChecked && wasChecked) {
                            qadaData[prayerName] = (qadaData[prayerName] || 0) + 1;
                        }
                        localStorage.setItem('adhan_qada', JSON.stringify(qadaData));
                        renderQada();
                    }
                }
            }

            prayerData[dateStr][prayerName] = isNowChecked; 
            localStorage.setItem('adhan_tracker', JSON.stringify(prayerData));
            
            if(prayerName !== 'Fast' && prayerName !== 'Kahf' && prayerName !== 'Exempt') {
                const prayersDone = TRACK_PRAYERS.filter(p => prayerData[dateStr][p]).length;
                if (prayersDone === 5 && isNowChecked && typeof confetti !== 'undefined') confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#D4AF37', '#2ecc71', '#ffffff'] });
            }
            updateStatistics();
        };

        function updateStatistics() {
            const d = new Date(); const actualTodayStr = d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
            const allDates = Object.keys(prayerData).sort().reverse();
            let weekCompleted = 0, weekMax = 0, monthCompleted = 0, monthMax = 0, entryCount = 0;
            let totalPrayersTracked = 0;

            let streak = 0;
            for (let i = 0; i < 365; i++) {
                let streakDate = new Date(); streakDate.setDate(streakDate.getDate() - i);
                let dStr = streakDate.getFullYear() + '-' + String(streakDate.getMonth() + 1).padStart(2, '0') + '-' + String(streakDate.getDate()).padStart(2, '0');
                
                let doneCount = prayerData[dStr] ? TRACK_PRAYERS.filter(p => prayerData[dStr][p]).length : 0;
                let isExempt = prayerData[dStr] ? prayerData[dStr].Exempt : false;
                
                if (doneCount === 5 || isExempt) { streak++; } 
                else if (i === 0) { continue; } 
                else { break; } 
            }
            document.getElementById('streak-display').innerText = `ğŸ”¥ ${streak} Day Streak`;

            let historyHTML = '';

            allDates.forEach((date, index) => {
                const dayRecord = prayerData[date]; const prayersDone = TRACK_PRAYERS.filter(p => dayRecord[p]).length;
                const fasted = dayRecord.Fast ? ' ğŸŒ™' : '';
                const exempt = dayRecord.Exempt;
                
                totalPrayersTracked += prayersDone;

                if (index < 7) { weekCompleted += exempt ? 5 : prayersDone; weekMax += 5; }
                if (index < 30) { monthCompleted += exempt ? 5 : prayersDone; monthMax += 5; }
                if (date !== actualTodayStr) {
                    entryCount++;
                    const color = exempt ? 'var(--info)' : (prayersDone === 5 ? 'var(--success)' : (prayersDone === 0 ? 'var(--danger)' : 'var(--gold)'));
                    const statText = exempt ? 'Exempt' : `${prayersDone} / 5${prayersDone === 5 ? ' â­' : ''}`;
                    
                    historyHTML += `<div class="history-row" onclick="jumpToDate('${date}')" title="Edit ${date}">
                        <span style="color: var(--text-main); font-weight: 500;">${date}${fasted}</span>
                        <span style="color: ${color}; font-weight: bold;">${statText}</span>
                    </div>`;
                }
            });

            document.getElementById('historyLog').innerHTML = historyHTML || '<div style="color: var(--text-muted); text-align: center; margin-top: 20px; font-style: italic;">No past data yet.</div>';
            document.getElementById('weekScore').innerText = weekCompleted; document.getElementById('weekTotal').innerText = weekMax;
            document.getElementById('weekBar').style.width = weekMax > 0 ? (weekCompleted / weekMax * 100) + '%' : '0%';
            document.getElementById('monthScore').innerText = monthCompleted; document.getElementById('monthTotal').innerText = monthMax;
            document.getElementById('monthBar').style.width = monthMax > 0 ? (monthCompleted / monthMax * 100) + '%' : '0%';
            
            if(document.getElementById('total-prayers-count')) {
                document.getElementById('total-prayers-count').innerText = totalPrayersTracked;
            }
        }

        function renderFocusModeTimes(activePrayerName) {
            if(!state.prayers || !DOM.focusTimesList) return;
            const seq = ["Fajr", "Sunrise", "Dhuhr", "Asr", "Maghrib", "Isha"];
            let focusHTML = '';
            
            seq.forEach(p => {
                const displayTime = addOffsetToString(state.prayers[p]);
                const isCurrent = (p === activePrayerName);
                
                const textColor = p === "Sunrise" ? "var(--danger)" : (isCurrent ? "var(--gold)" : "var(--text-main)");
                const bgStyle = isCurrent ? "background: var(--highlight-bg); border-radius: 6px; padding: 8px 10px;" : "padding: 8px 10px;";
                const arrow = isCurrent ? `<span style="color: var(--gold); margin-right: 5px;">â”</span>` : `<span style="visibility:hidden; margin-right: 5px;">â”</span>`;

                focusHTML += `<div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); ${bgStyle}">
                    <div style="display: flex; align-items: center;">${arrow}<span style="color: ${textColor}; font-weight: ${isCurrent?'bold':'normal'};">${p}</span></div>
                    <span style="color: var(--gold); font-family: 'Courier New', monospace; font-weight: bold; font-size: 1.2rem;">${displayTime}</span>
                </div>`;
            });
            DOM.focusTimesList.innerHTML = focusHTML;
        }

        async function init() {
            processAutoQada(); 
            initUI();
            try { applySettings(); } catch(e) {}
            requestWakeLock(); 
            updateGregorian(); 
            
            setInterval(() => { 
                const d = new Date();
                if(DOM.liveClock) DOM.liveClock.innerText = d.toLocaleTimeString('en-US', { hour12: false }); 
                
                if(document.body.classList.contains('ambient-active')) {
                    document.getElementById('ambient-clock').innerText = d.toLocaleTimeString('en-US', { hour12: false });
                    if(DOM.timerDisp) document.getElementById('ambient-next').innerText = `${state.nextPrayer ? state.nextPrayer.name : ''} in ${DOM.timerDisp.innerText}`;
                }
            }, 1000);
            
            if(new Date().getDay() === 5 && DOM.jumuahBanner) {
                DOM.jumuahBanner.style.display = 'block';
            }

            try { await initLocation(); } catch(e) {}
            fetchContent(); 
            
            setInterval(tickTimer, 1000); 
            setInterval(rotateNames, 10000); 
            
            checkOnboarding();
        }

        async function fetchWeather() {
            const data = await fetchCached(`weather_${config.lat}_${config.lon}`, `https://api.open-meteo.com/v1/forecast?latitude=${config.lat}&longitude=${config.lon}&current_weather=true`, 1);
            if(data && data.current_weather && DOM.weather) DOM.weather.innerText = `${Math.round(data.current_weather.temperature)}Â°C | ${data.current_weather.weathercode < 3 ? 'Clear' : 'Cloudy'}`;
        }

        async function fetchContent() {
            const lang = localStorage.getItem('adhan_lang') || 'en';
            const dailySource = localStorage.getItem('adhan_daily') || 'quran';
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
            
            if (dailySource === 'quran') {
                const quranEditions = { en: 'en.asad', tr: 'tr.diyanet', nl: 'nl.leemhuis', fr: 'fr.hamidullah', de: 'de.aburida', es: 'es.cortes', ar: 'ar.alafasy' };
                const edition = quranEditions[lang] || 'en.asad';
                const ayahNumber = (dayOfYear % 6236) + 1;
                const ayahData = await fetchCached(`quran_${edition}_${ayahNumber}`, `https://api.alquran.cloud/v1/ayah/${ayahNumber}/${edition}`, 24);
                if(ayahData && ayahData.data) {
                    document.getElementById('daily-text').innerText = `"${ayahData.data.text}"`;
                    let surahName = lang === 'ar' ? ayahData.data.surah.name : ayahData.data.surah.englishName;
                    document.getElementById('daily-ref').innerText = surahName + " " + ayahData.data.surah.number + ":" + ayahData.data.numberInSurah;
                    if(DOM.qQuranLink) DOM.qQuranLink.href = `https://quran.com/${ayahData.data.surah.number}/${ayahData.data.numberInSurah}`;
                }
            } else {
                const hIndex = dayOfYear % dailyHadiths.length;
                document.getElementById('daily-text').innerText = `"${dailyHadiths[hIndex].text}"`; 
                document.getElementById('daily-ref').innerText = dailyHadiths[hIndex].ref;
            }

            const dIndex = dayOfYear % dailyDuas.length;
            document.getElementById('dua-text').innerText = `"${dailyDuas[dIndex].text}"`; 
            document.getElementById('dua-ref').innerText = dailyDuas[dIndex].ref;

            const namesData = await fetchCached('allah_names_v1', 'https://api.aladhan.com/v1/asmaAlHusna', 720);
            if(namesData && namesData.data) { state.namesList = namesData.data; rotateNames(); }
        }

        function determinePrayerState() {
            if(!state.prayers || !state.prayers.Fajr) return;
            const now = new Date(); const seq = ["Fajr", "Sunrise", "Dhuhr", "Asr", "Maghrib", "Isha"];
            
            let currentName = "Isha";
            
            for(let i=0; i<seq.length; i++) {
                const pTime = parseTime(state.prayers[seq[i]]);
                if(pTime > now) {
                    state.nextPrayer = { name: seq[i], time: pTime };
                    let prevName = i === 0 ? "Isha" : seq[i-1]; let prevTime = parseTime(state.prayers[prevName]);
                    if(i === 0) prevTime.setDate(prevTime.getDate() - 1);
                    state.prevPrayerTime = prevTime;
                    
                    if(DOM.currName) DOM.currName.innerText = prevName; 
                    if(DOM.currTime) DOM.currTime.innerText = addOffsetToString(state.prayers[prevName]);
                    if(DOM.currName) DOM.currName.style.color = prevName === "Sunrise" ? "var(--danger)" : "var(--gold)";
                    if(DOM.shuruqWarn) DOM.shuruqWarn.style.display = prevName === "Sunrise" ? 'block' : 'none';
                    
                    currentName = prevName;
                    renderFocusModeTimes(prevName);
                    updateDynamicTheme(); state.notified10Min = false; state.tahajjudAlarmPlayed = false; break;
                }
            }
            
            if (!state.nextPrayer || state.nextPrayer.time < now) {
                const fTime = parseTime(state.prayers.Fajr); fTime.setDate(fTime.getDate()+1);
                state.nextPrayer = { name: "Fajr", time: fTime }; state.prevPrayerTime = parseTime(state.prayers.Isha);
                
                if(DOM.currName) { DOM.currName.innerText = "Isha"; DOM.currName.style.color = "var(--gold)"; }
                if(DOM.currTime) DOM.currTime.innerText = addOffsetToString(state.prayers.Isha); 
                if(DOM.shuruqWarn) DOM.shuruqWarn.style.display = 'none';
                
                currentName = "Isha";
                renderFocusModeTimes("Isha"); 
                updateDynamicTheme(); state.notified10Min = false; state.tahajjudAlarmPlayed = false;
            }

            if (localStorage.getItem('adhan_autodim') === 'true') {
                if (currentName === 'Isha' || currentName === 'Midnight' || currentName === 'Lastthird') {
                    document.body.classList.add('night-dimmed');
                } else {
                    document.body.classList.remove('night-dimmed');
                }
            } else {
                document.body.classList.remove('night-dimmed');
            }
        }

        function tickTimer() {
            const now = new Date();
            
            if (now.getHours() === 9 && now.getMinutes() === 0) {
                if (!state.dailyAlertTriggered && localStorage.getItem('adhan_daily_alert') === 'true') {
                    showNotification("Daily Inspiration", { body: document.getElementById('daily-text').innerText });
                    state.dailyAlertTriggered = true;
                }
            } else { state.dailyAlertTriggered = false; }
            
            if(!state.nextPrayer) return;
            const diffMs = state.nextPrayer.time - now;

            if (state.nextPrayer.name === "Fajr" && localStorage.getItem('adhan_tahajjud_alarm') === 'true' && !state.tahajjudAlarmPlayed) {
                const tahajjudMs = diffMs - (30 * 60000);
                if (tahajjudMs <= 0 && tahajjudMs > -60000) {
                    playAudio('chime');
                    showNotification("Tahajjud Time", { body: `30 minutes until Fajr. Wake up for Qiyam.` });
                    state.tahajjudAlarmPlayed = true;
                }
            }
            
            if (diffMs <= 600000 && diffMs > 599000 && !state.notified10Min) { 
                if(localStorage.getItem('adhan_wudu') === 'true' && state.nextPrayer.name !== "Sunrise") { 
                    playAudio('chime'); 
                    showNotification("Prayer Time Approaching", { body: `10 minutes until ${state.nextPrayer.name}. Time for Wudu.` });
                }
                state.notified10Min = true; 
            }

            if (diffMs <= 0) { 
                if(!state.adhanPlayed) { 
                    if (state.nextPrayer.name !== "Sunrise") playAudio('adhan'); 
                    state.adhanPlayed = true; 
                }
                determinePrayerState(); state.adhanPlayed = false; return; 
            }
            
            const h = Math.floor(diffMs/3600000).toString().padStart(2,'0');
            const m = Math.floor((diffMs%3600000)/60000).toString().padStart(2,'0');
            const s = Math.floor((diffMs%60000)/1000).toString().padStart(2,'0');
            if(DOM.timerDisp) DOM.timerDisp.innerText = `${h}:${m}:${s}`;
            
            if(state.prevPrayerTime && DOM.progress) {
                const total = state.nextPrayer.time - state.prevPrayerTime;
                const elapsed = now - state.prevPrayerTime;
                DOM.progress.style.width = `${(elapsed/total)*100}%`;
            }

            if(state.isRamadan) {
                const fajrTime = parseTime(state.prayers.Fajr); const maghribTime = parseTime(state.prayers.Maghrib);
                let targetTime, label;
                if(now >= fajrTime && now < maghribTime) { targetTime = maghribTime; label = "Time until Iftar (Maghrib)"; } 
                else { targetTime = parseTime(state.prayers.Fajr); if (now >= maghribTime) targetTime.setDate(targetTime.getDate() + 1); label = "Time until Imsak (Fajr)"; }
                const fastDiff = targetTime - now;
                const fh = Math.floor(fastDiff/3600000).toString().padStart(2,'0'); const fm = Math.floor((fastDiff%3600000)/60000).toString().padStart(2,'0'); const fs = Math.floor((fastDiff%60000)/1000).toString().padStart(2,'0');
                document.getElementById('fasting-label').innerText = label; document.getElementById('fasting-timer').innerText = `${fh}:${fm}:${fs}`;
            }
        }

        function showNotification(title, customOptions = {}) {
            const options = { icon: "images/adhan display muslim prayer times dashboard logo.png", badge: "images/adhan display muslim prayer times dashboard logo.png", vibrate: [200, 100, 200], ...customOptions };
            if (!("Notification" in window) || Notification.permission !== "granted") return;
            if (navigator.serviceWorker && navigator.serviceWorker.controller) navigator.serviceWorker.ready.then(reg => reg.showNotification(title, options));
            else new Notification(title, options);
        }

        function activateRamadanMode(hijriDay) { 
            document.getElementById('ramadan-countdown-container').style.display = 'none'; document.getElementById('ramadan-panel').style.display = 'block'; 
            let ashraName = "Mercy (Days 1-10)"; if (hijriDay > 10 && hijriDay <= 20) ashraName = "Forgiveness (Days 11-20)"; if (hijriDay > 20) ashraName = "Refuge (Days 21-30)";
            document.getElementById('ashra-label').innerText = `Ashra: ${ashraName}`; document.getElementById('ramadan-day-label').innerText = `Day ${hijriDay} of 30`;
            document.getElementById('ashra-progress-fill').style.width = `${(hijriDay / 30) * 100}%`;
        }

        function calcRamadanCountdown(m, d) { 
            document.getElementById('ramadan-countdown-container').style.display = 'flex'; document.getElementById('ramadan-panel').style.display = 'none'; 
            let daysLeft = m < 9 ? Math.floor(((9 - m - 1) * 29.5) + (30 - d)) : Math.floor(((12 - m + 8) * 29.5) + (30 - d));
            document.getElementById('ramadan-val').innerText = daysLeft > 0 ? daysLeft : 0;
        }

        function calculateQibla() {
            const lat1 = config.lat * (Math.PI/180), lon1 = config.lon * (Math.PI/180), lat2 = 21.4225 * (Math.PI/180), lon2 = 39.8262 * (Math.PI/180);
            const y = Math.sin(lon2 - lon1) * Math.cos(lat2), x = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);
            state.qiblaDegree = Math.round(((Math.atan2(y, x) * 180/Math.PI) + 360) % 360);
            document.getElementById('qibla-degree').innerText = state.qiblaDegree + "Â°";
        }

        function rotateNames() {
            if(!state.namesList || !state.namesList.length) return;
            const item = state.namesList[Math.floor(Math.random()*state.namesList.length)];
            document.getElementById('allah-ar').innerText = item.name; document.getElementById('allah-en').innerText = item.transliteration;
            document.getElementById('allah-meaning').innerText = item.en.meaning; 
        }

        function parseTime(t) { 
            const d = new Date(); 
            const timeClean = t.split(' ')[0]; 
            const [h, m] = timeClean.split(':'); 
            return new Date(d.getFullYear(), d.getMonth(), d.getDate(), parseInt(h), parseInt(m) + config.offset); 
        }
        
        function addOffsetToString(t) {
            const dateObj = parseTime(t);
            return String(dateObj.getHours()).padStart(2, '0') + ':' + String(dateObj.getMinutes()).padStart(2, '0');
        }

        function updateGregorian() { const n = new Date(); if(DOM.gregDate) DOM.gregDate.innerText = `${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`; }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => { navigator.serviceWorker.register('sw.js').catch((err) => { console.log('SW error: ', err); }); });
        }

        init();
    </script>
</body>
</html>
